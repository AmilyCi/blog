<!DOCTYPE html>


<html lang="zh-CN" >


<head>
  <meta charset="utf-8" />
    
  <meta name="description" content="å‰ç«¯" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     å‰ç«¯å°ç™½èœ
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/blog/dist/main.css">

  
<link rel="stylesheet" href="/blog/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

</head>

</html>

<body>
  <div id="app">
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/blog/images/cover8.JPG" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/blog/">å‰ç«¯å°ç™½èœ</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article id="post-promise" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/11/04/promise/"
    >æ·±å…¥ç†è§£promise</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/11/04/promise/" class="article-date">
  <time datetime="2020-11-04T08:13:48.000Z" itemprop="datePublished">2020-11-04</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ç”±äº JS æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æœ‰äº›å¤„ç†ä¸å¾—ä¸ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œçš„æ–¹å¼ï¼Œæ¯”å¦‚è¯·æ±‚æ•°æ®å•¦ï¼Œæµè§ˆå™¨çš„ä¸€äº›æ–¹æ³•å•¦ç­‰ç­‰ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€ç§åœºæ™¯å­˜åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æ¥ä¸‹æ¥çš„é€»è¾‘éœ€è¦ä¾èµ–å¼‚æ­¥æ‰§è¡Œåçš„ç»“æœæ€ä¹ˆåŠï¼Ÿåœ¨è¿‡å»ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨å›è°ƒå‡½æ•°çš„æ–¹æ³•æ¥è§£å†³ï¼Œå°±åƒä¸‹é¢è¿™ä¸ªä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">request.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (request.readyState === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-keyword">if</span> (request.status === <span class="hljs-number">200</span>) &#123;<br>            <span class="hljs-keyword">return</span> success(request.responseText);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> fail(request.status);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å‡å¦‚æˆ‘ä»¬æœ‰å¤šä¸ªè¯·æ±‚éƒ½æ˜¯ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ä¸€ä¸ªå›è°ƒå‡½æ•°å†…åµŒå¥—å¦ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¿™æ ·çš„ä»£ç çœ‹èµ·æ¥çœŸçš„ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œä¹Ÿä¸åˆ©äºåæœŸä»£ç çš„ç»´æŠ¤ğŸ˜–ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// ç±»ä¼¼è¿™æ ·ï¼Œå›è°ƒåœ°ç‹±ï¼Œæƒ³æƒ³éƒ½å¯æ€•</span><br>ajax(url, () =&gt; &#123;<br>    <span class="hljs-comment">// å¤„ç†é€»è¾‘</span><br>    ajax(url1, () =&gt; &#123;<br>        <span class="hljs-comment">// å¤„ç†é€»è¾‘</span><br>        ajax(url2, () =&gt; &#123;<br>            <span class="hljs-comment">// å¤„ç†é€»è¾‘</span><br>        &#125;)<br>    &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒPromise å°±è¯ç”Ÿäº†ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ï¼Œå®ƒæ˜¯ ES6 ä¸­çš„è¯­æ³•ï¼Œæœ‰äº†å®ƒæˆ‘ä»¬å°±å†ä¹Ÿä¸ç”¨å†™è¿™ç§æ¶å¿ƒçš„å›è°ƒåœ°ç‹±å¼ä»£ç ã€‚</p>
<h3 id="åˆè¯†Promise"><a href="#åˆè¯†Promise" class="headerlink" title="åˆè¯†Promise"></a>åˆè¯†Promise</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;promise ç¿»è¯‘æˆä¸­æ–‡æ˜¯å…è¯ºï¼Œè®¸è¯ºçš„æ„æ€ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå…è¯ºåœ¨æœªæ¥çš„æŸä¸€ä¸ªæ—¶åˆ»ä¼šæœ‰ä¸€ä¸ªç¡®åˆ‡çš„ç­”å¤ï¼Œå¹¶ä¸”è¿™ä¸ªå…è¯ºæœ‰ä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>ç­‰å¾…ä¸­ï¼ˆpendingï¼‰</li>
<li>å®Œæˆäº†ï¼ˆresolvedï¼‰</li>
<li>æ‹’ç»äº†ï¼ˆrejectedï¼‰</li>
</ul>
<p>ä¸€æ—¦ä»ç­‰å¾…çŠ¶æ€è½¬å˜ä¸ºå…¶å®ƒçŠ¶æ€å°±ä¸èƒ½å†æ”¹å˜äº†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>  reject(<span class="hljs-string">'fail'</span>) <span class="hljs-comment">// æ— æ•ˆï¼Œå·²ç»å˜æˆ resolved çŠ¶æ€</span><br>&#125;)<br></code></pre></td></tr></table></figure>
<p>Promise æ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç æ˜¯ç«‹å³æ‰§è¡Œçš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'start'</span>)<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>)<br><br><span class="hljs-comment">// start  end</span><br></code></pre></td></tr></table></figure>
<p>Promise å®ç°äº†é“¾å¼è°ƒç”¨ï¼Œæ¯æ¬¡è°ƒç”¨ then ä¹‹åéƒ½ä¼šè¿”å›ä¸€ä¸ªå…¨æ–°çš„ Promiseï¼Œåœ¨ then ä¸­å¦‚æœä½¿ç”¨äº† return , return ä¸­çš„å€¼å°±ä¼šè¢« Promise.resolve() åŒ…è£¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">'111'</span><br>&#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;)<br><span class="hljs-comment">// success    111</span><br></code></pre></td></tr></table></figure>
<p>ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹çœ‹ Promise å¦‚ä½•è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜å§ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">ajax(url)<br>  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(res)<br>      <span class="hljs-keyword">return</span> ajax(url1)<br>  &#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(res)<br>      <span class="hljs-keyword">return</span> ajax(url2)<br>  &#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(res))<br></code></pre></td></tr></table></figure>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; ç°åœ¨ï¼Œä½ æ˜¯å¦å¯¹ Promise æœ‰ä¸€ä¸ªå¤§ä½“çš„äº†è§£äº†å‘¢ï¼ŒPromise è¿˜æœ‰å…¶å®ƒä¸€äº›å¥½ç”¨çš„ APIï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¸ä¸€ä¸€çš„è¯¦è¿°å•¦ï¼Œå¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹ MDN å®˜æ–¹çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">æ–‡æ¡£</a>ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥çœ‹ä¸€ä¸‹<a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023024413276544" target="_blank" rel="noopener">å»–é›ªå³°çš„åšå®¢</a>è¿›è¡Œæ·±å…¥çš„äº†è§£ã€‚æœ€åé™„ä¸Šä¸€å¼ å®˜æ–¹çš„å›¾ç‰‡ï¼Œè¿™å¼ å›¾å°† Promise è§£é‡Šçš„æ·‹æ¼“å°½è‡´ã€‚</p>
<img src="/blog/2020/11/04/promise/promise.png" class="">

<h3 id="è¿›é˜¶Promise"><a href="#è¿›é˜¶Promise" class="headerlink" title="è¿›é˜¶Promise"></a>è¿›é˜¶Promise</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å½“ç„¶ï¼Œæœ‰è¿½æ±‚çš„æˆ‘ä»¬æ€èƒ½å•å•çš„ä»…é™äºå¦‚ä½•ä½¿ç”¨çš„å±‚é¢å‘¢ğŸ™„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å¤§å±•èº«æ‰‹å®ç°ä¸€ä¸ªç›—ç‰ˆçš„ PromiseğŸ˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  reolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function">(<span class="hljs-params">res</span>)=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;,(err)=&gt; &#123;<br>  <span class="hljs-built_in">console</span>.log(err)<br>&#125;)<br></code></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¿™æ®µä»£ç æ˜¯æˆ‘ä»¬æ­£å¸¸çš„ä¸€ä¸ª promise è°ƒç”¨ã€‚</p>
<ul>
<li><p>æˆ‘ä»¬å…ˆåˆ›å»ºäº†ä¸€ä¸ª Promise å®ä¾‹ã€‚</p>
</li>
<li><p>ç»™è¿™ä¸ªå®ä¾‹ä¼ è¿›äº†ä¸€ä¸ªå‡½æ•°æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°å‚æ•°æ˜¯åŒæ­¥çš„ï¼Œä¼šç›´æ¥è¿è¡Œï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°ä¹Ÿæ¥æ”¶äº†ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œåˆ†åˆ«ä»£è¡¨ æˆåŠŸæ—¶å€™æ‰§è¡Œçš„å›è°ƒ å’Œ å¤±è´¥çš„æ—¶å€™æ‰§è¡Œçš„å›è°ƒã€‚</p>
</li>
<li><p>æˆ‘ä»¬åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œäº†è¿™ä¸ªæˆåŠŸçš„å›è°ƒï¼Œå¹¶ä¸”ä¼ è¿›äº†ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°</p>
</li>
<li><p>ä¹‹åå‘¢æˆ‘ä»¬è°ƒç”¨äº† thenï¼Œè¿™ä¸ª then æ–¹æ³•æ¥æ”¶äº†ä¸¤ä¸ªå‡½æ•°æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œä¸€ä¸ªä»£è¡¨æˆåŠŸçš„å›è°ƒï¼Œä¸€ä¸ªä»£è¡¨å¤±è´¥çš„å›è°ƒï¼Œæˆ‘ä»¬ä¼šæ ¹æ®è°ƒç”¨äº† resolve è¿˜æ˜¯ reject æ¥æ‰§è¡Œå¯¹åº”çš„å›è°ƒã€‚</p>
</li>
<li><p>åœ¨è¿™é‡Œå‘¢ï¼Œæˆ‘ä»¬æ‰§è¡Œäº† resolve å›è°ƒï¼Œå¹¶ä¼ è¿›äº†ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå‚æ•°æˆåŠŸçš„æ‰“å°å‡ºæ¥å•¦ã€‚</p>
</li>
<li><p>ç»“æŸã€‚ã€‚ã€‚</p>
</li>
</ul>
<p>åˆ°ç°åœ¨æˆ‘ä»¬ä¸€æ­¥æ­¥åˆ†æå®Œäº†ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥æ­¥çš„å®ç°å§ğŸ’ªğŸ»ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª Mypromise æ„é€ å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span></span>&#123;<br>  <span class="hljs-keyword">constructor</span>()&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å“ˆå“ˆï¼Œåˆ›å»ºå¥½å•¦ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚<br>ç°åœ¨æˆ‘ä»¬æŒ‰ç…§æ­¥éª¤ï¼Œåº”è¯¥ç»™è¿™ä¸ªæ„é€ å‡½æ•°ä¼ å‚ï¼Œè¿˜æ˜¯ä¸€ä¸ªå‡½æ•°æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œå¹¶ä¸”è¦ç›´æ¥è¿è¡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span></span>&#123;<br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    excution(resolve, reject)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°è¿™é‡Œçš„ resolve å’Œ reject è¿™ä¸¤ä¸ªå‡½æ•°å‚æ•°å¹¶æ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸‹ï¼Œå¹¶ä¸”è¿˜è¦å®šä¹‰ä¸‰ç§çŠ¶æ€çš„å¸¸é‡ï¼Œåˆå§‹åŒ–çš„çŠ¶æ€ä¸ºpendingã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span></span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>)</span>&#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status = PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)</span>&#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status = PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>      &#125;<br>    &#125;<br>    excution(resolve, reject)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬è¿˜é¡ºä¾¿æŠŠ æˆåŠŸ å’Œ å¤±è´¥ çš„å›è°ƒå‡½æ•°ä¼ å‚ç»™å®ç°äº†ï¼Œç›¸å½“äº<code>result(&#39;success&#39;)</code>ã€‚å› ä¸º Promise åªæœ‰åœ¨çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šæ”¹å˜çŠ¶æ€ï¼Œæ‰§è¡Œ resolve å’Œ reject å›è°ƒæ—¶æˆ‘ä»¬çš„çŠ¶æ€ä¼šæ”¹å˜ï¼Œå¹¶ä¸”å°†å‚æ•°å­˜èµ·æ¥ã€‚</p>
<p>ä¹‹åæˆ‘ä»¬å°±è¦å¼€å§‹å®ç° then å‡½æ•°å•¦ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span></span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>      &#125;<br>    &#125;<br>    excution(resolve, reject)<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>      onResolved(<span class="hljs-keyword">this</span>.result)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>      onRejected(<span class="hljs-keyword">this</span>.reason)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹æˆ‘ä»¬åˆè§é›å½¢çš„ promise å§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(res)<br>&#125;, err =&gt; &#123;&#125;)<br><br><span class="hljs-comment">// success</span><br></code></pre></td></tr></table></figure>
<p>æ²¡é—®é¢˜ï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä¹ˆå·²ç»å®ç°äº†ä¸€ä¸ªåŸºæœ¬çš„ promise å•¦ï¼Œå“ˆå“ˆå“ˆï¼Œæ¿€åŠ¨ä¸ğŸ˜ï¼Œæ¥ï¼Œæˆ‘ä»¬ç»§ç»­å‘ç°é—®é¢˜ï¼Œè§£å†³é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>)<br><span class="hljs-comment">// end success</span><br></code></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>)<br><span class="hljs-comment">// success end</span><br></code></pre></td></tr></table></figure>
<p>ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼Œæˆ‘ä»¬ç›—ç‰ˆ promise å¾—åˆ°ç»“æœçš„é¡ºåºå’Œæ­£ç‰ˆçš„ç»“æœé¡ºåºä¸å¤ªä¸€æ ·è¯¶ï¼Œè®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚</p>
<p>çœ‹è¿‡æ–‡æ¡£çš„åŒå­¦åº”è¯¥å·²ç»çŸ¥é“äº†ï¼Œå› ä¸ºthenæ–¹æ³•æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè€Œæˆ‘ä»¬ç°åœ¨å®ç°çš„æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥ä¼šä»ä¸Šåˆ°ä¸‹æ­£å¸¸è¾“å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜å§ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span></span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>      &#125;<br>    &#125;<br>    excution(resolve, reject)<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onResolved(<span class="hljs-keyword">this</span>.result)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onRejected(<span class="hljs-keyword">this</span>.reason)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç”¨ setTimeout å°†å…¶åŒ…è£¹ä¸€ä¸‹ï¼Œè¿™ä¸å°±å˜æˆå¼‚æ­¥äº†ä¹ˆï¼Œæ¥ï¼Œå†è®©æˆ‘ä»¬è¯•è¯•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>)<br><span class="hljs-comment">// end  success</span><br></code></pre></td></tr></table></figure>
<p>OK! No problemï¼Œæˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¼€å§‹åˆ‡æ¢ä¸‹ä¸€ä¸ªåœºæ™¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    resolve(<span class="hljs-string">'success'</span>)<br>  &#125;,<span class="hljs-number">1000</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;, err =&gt; &#123;&#125;)<br></code></pre></td></tr></table></figure>
<p>å—¯ï¼Ÿçº³å°¼ï¼Œæ€ä¹ˆä»€ä¹ˆéƒ½æ²¡æœ‰è¾“å‡ºå‘€ï¼Œä¸æ˜¯åº”è¯¥åœ¨1sä¹‹åè¾“å‡º success ä¹ˆï¼Œå’Œæˆ‘ä»¬æƒ³çš„ä¸ä¸€æ ·ï¼Œå¥½å§ï¼Œè®©æˆ‘ä»¬æ¥åº·åº·æˆ‘ä»¬å®ç°çš„ä»£ç ï¼Œåˆ†æä¸€ä¸‹ã€‚ã€‚ã€‚ã€‚</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œåœ¨æˆ‘ä»¬æ‰§è¡Œ then æ–¹æ³•æ—¶ï¼Œæ­¤æ—¶çš„çŠ¶æ€è¿˜æ˜¯ pendingï¼Œå› ä¸ºåœ¨æˆ‘ä»¬åˆ›å»ºå®ä¾‹çš„æ—¶å€™å†™äº†ä¸€ä¸ªå¼‚æ­¥çš„æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰æ‰§è¡Œè¿™ä¸ªæ–¹æ³•å‰ï¼ŒçŠ¶æ€éƒ½ä¸ä¼šæ”¹å˜ï¼Œä¸€ç›´æ˜¯pendingï¼Œè€Œæˆ‘ä»¬å®ç°çš„ then æ–¹æ³•å¹¶æ²¡æœ‰åˆ¤æ–­çŠ¶æ€ä¸º pending æ—¶çš„å¤„ç†é€»è¾‘ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸ä¼šæ‰“å°å‡ºæ¥ã€‚</p>
<p>é‚£æˆ‘ä»¬æ•´ç†ä¸€ä¸‹æ€è·¯ï¼Œè¿™æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸€ä¸ªè®¢é˜…è€…æ¨¡å¼ï¼Œåœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬å†åˆ¤æ–­æ‰§è¡Œå“ªä¸ªå›è°ƒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span> </span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  onResolvedArr = []<br>  onRejectedArr = []<br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>        <span class="hljs-keyword">this</span>.onResolvedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>        <span class="hljs-keyword">this</span>.onRejectedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    excution(resolve, reject)<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onResolved(<span class="hljs-keyword">this</span>.result)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onRejected(<span class="hljs-keyword">this</span>.reason)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>      <span class="hljs-keyword">this</span>.onResolvedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onResolved(<span class="hljs-keyword">this</span>.result)<br>      &#125;)<br>      <span class="hljs-keyword">this</span>.onRejectedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onRejected(<span class="hljs-keyword">this</span>.reason)<br>      &#125;)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¢åŠ ä¸¤ä¸ªæ•°ç»„ onResolved å’Œ onRejected ï¼Œåœ¨thenæ–¹æ³•ä¸­åˆ¤æ–­çŠ¶æ€ä¸º pending æ—¶ï¼ˆä¸º pending ä»£è¡¨æ–¹æ³•å†…æ˜¯å¼‚æ­¥çš„ï¼‰ï¼Œå°†äº‹ä»¶åˆ†åˆ«æ·»åŠ åˆ°è¿™ä¸¤ä¸ªæ•°ç»„ä¸­ï¼Œç­‰å¾…çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    resolve(<span class="hljs-string">'success'</span>)<br>  &#125;,<span class="hljs-number">1000</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;, err =&gt; &#123;&#125;)<br><br><span class="hljs-comment">// è¿‡äº†1så  success</span><br></code></pre></td></tr></table></figure>
<p>å®˜æ–¹çš„ç‰ˆæœ¬æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯åœ¨äº .then çš„é“¾å¼è°ƒç”¨ï¼Œå°±åƒè¿™æ ·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  resolve(<span class="hljs-string">'success'</span>)<br>&#125;)<br>promise.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">'11111'</span><br>&#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(res)<br>&#125;)<br><br><span class="hljs-comment">// success   11111</span><br></code></pre></td></tr></table></figure>
<p>ç„¶é¹…~~æˆ‘ä»¬å¹¶ä¸æ”¯æŒï¼Œå› ä¸ºæˆ‘ä»¬çš„ then æ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œè¿”å›æ˜¯ undefinedï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®© then è¿”å›ä¸€ä¸ª Mypromise å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»§ç»­è°ƒç”¨ then æ–¹æ³•äº†ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ then æ–¹æ³•çš„æ”¹å†™</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">then(onResolved, onRejected)&#123;<br>  <span class="hljs-keyword">const</span> newPromise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onResolved(<span class="hljs-keyword">this</span>.result)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onRejected(<span class="hljs-keyword">this</span>.reason)<br>      &#125;, <span class="hljs-number">0</span>)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>      <span class="hljs-keyword">this</span>.onResolvedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onResolved(<span class="hljs-keyword">this</span>.result)<br>      &#125;)<br>      <span class="hljs-keyword">this</span>.onRejectedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        onRejected(<span class="hljs-keyword">this</span>.reason)<br>      &#125;)<br>    &#125;<br>  &#125;)<br>  <span class="hljs-keyword">return</span> newPromise<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬è™½ç„¶åœ¨å†™ .then çš„é“¾å¼è°ƒç”¨ä¸ä¼šæŠ¥é”™äº†ï¼Œä½†æ˜¯ï¼Œresolve å’Œ reject ä¸€ç›´éƒ½æ²¡æœ‰æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-keyword">const</span> handlePromise = <span class="hljs-function">(<span class="hljs-params">result, newPromise, resolve, reject</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span>(result === newPromise)&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'can not return oneself'</span>)<br>  &#125;<br>  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>) || <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>)&#123;<br>    <span class="hljs-keyword">const</span> then  = result.then<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> then === <span class="hljs-string">'function'</span>)&#123;<br>      then.call(<br>        result,<br>        r =&gt; &#123;<br>          handlePromise(r, newPromise, resolve, reject)<br>        &#125;,<br>        e =&gt; &#123;<br>          reject(e)<br>        &#125;)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      resolve(then)<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    resolve(result)<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span> </span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  onResolvedArr = []<br>  onRejectedArr = []<br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>        <span class="hljs-keyword">this</span>.onResolvedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>        <span class="hljs-keyword">this</span>.onRejectedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    excution(resolve, reject)<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    <span class="hljs-keyword">const</span> newPromise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>          handlePromise(result, newPromise, resolve, reject)<br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>          handlePromise(result, newPromise, resolve, reject)<br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.onResolvedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>          handlePromise(result, newPromise, resolve, reject)<br>        &#125;)<br>        <span class="hljs-keyword">this</span>.onRejectedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>          handlePromise(result, newPromise, resolve, reject)<br>        &#125;)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newPromise<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªå¸¸é‡ result æ¥æ¥æ”¶ç¬¬ä¸€æ¬¡è°ƒç”¨ then çš„è¿”å›å€¼</p>
</li>
<li><p>å®šä¹‰ä¸€ä¸ªæ–¹æ³• handlePromiseï¼Œç»™è¿™ä¸ªæ–¹æ³•ä¼ å…¥ result newPromise resolve reject</p>
</li>
<li><p>åœ¨æ–¹æ³•ä¸­æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ result å’Œ newPromise æ˜¯å¦ç›¸ç­‰ï¼Œåœ¨åŸç”Ÿçš„ Promise ä¸­æ˜¯ä¸å¯ä»¥å°†è‡ªèº«è¿”å›çš„ï¼Œè¿™æ ·æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ¤æ–­ä¸¤è€…è‹¥ç›¸ç­‰ï¼Œå°±ä¼šæŠ¥é”™</p>
</li>
<li><p>ç»§ç»­åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ª result æ˜¯å¦ä¸ºä¸€ä¸ª promise ç±»å‹çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦ä¸ºä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°</p>
</li>
<li><p>å¦‚æœä¸Šä¸€æ­¥åˆ¤æ–­ä¸º trueï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»§ç»­åˆ¤æ–­æ˜¯å¦æœ‰ then è¿™ä¸ªæ–¹æ³•ï¼›å¦‚æœä¸Šä¸€æ­¥åˆ¤æ–­ä¸ºfalseï¼Œè¯´æ˜è¿™ä¸ª result æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥æ‰§è¡Œ <code>resolve(result)</code>ï¼Œå¹¶å°†å‚æ•°ä¼ è¿›å»ã€‚(å¤„ç†å‡å¦‚ result ä¸º {then: â€˜123â€™} )</p>
</li>
<li><p>å½“æˆ‘ä»¬ç¡®å®š result æ˜¯ä¸€ä¸ª promise æ—¶ï¼Œæˆ‘ä»¬å°±ç»§ç»­å›è°ƒ handlePromiseï¼Œç›´åˆ°å®ƒæ˜¯ä¸€ä¸ªç¡®åˆ‡çš„å€¼ï¼Œè€Œä¸æ˜¯ promiseã€‚</p>
</li>
</ul>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ promise ç»å®Œæˆå¤§éƒ¨åˆ†äº†ï¼Œè¿˜éœ€å¤„ç†å¼‚å¸¸æƒ…å†µï¼Œæˆ‘ä»¬ç”¨ tryâ€¦catchâ€¦ æ¥æ•è·å„ä¸ªé˜¶æ®µçš„é”™è¯¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-keyword">const</span> handlePromise = <span class="hljs-function">(<span class="hljs-params">result, newPromise, resolve, reject</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span>(result === newPromise)&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'can not return oneself'</span>)<br>  &#125;<br>  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>) || <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>)&#123;<br>    <span class="hljs-keyword">let</span> lock = <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">try</span>&#123;<br>      <span class="hljs-keyword">const</span> then  = result.then<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> then === <span class="hljs-string">'function'</span>)&#123;<br>        then.call(<br>          result,<br>          r =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (lock) <span class="hljs-keyword">return</span><br>            handlePromise(r, newPromise, resolve, reject)<br>            lock = <span class="hljs-literal">true</span><br>          &#125;,<br>          e =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (lock) <span class="hljs-keyword">return</span><br>            reject(e)<br>            lock = <span class="hljs-literal">true</span><br>          &#125;)<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        resolve(then)<br>      &#125;<br>    &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>      reject(error)<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    resolve(result)<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span> </span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  onResolvedArr = []<br>  onRejectedArr = []<br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>        <span class="hljs-keyword">this</span>.onResolvedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>        <span class="hljs-keyword">this</span>.onRejectedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">try</span>&#123;<br>      excution(resolve, reject)<br>    &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>      reject(error)<br>    &#125;<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    <span class="hljs-keyword">const</span> newPromise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;  <br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.onResolvedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;)<br>        <span class="hljs-keyword">this</span>.onRejectedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newPromise<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä¹‹åæˆ‘ä»¬å†å®ç°ä¸€ä¸ªcatchæ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">'pending'</span><br><span class="hljs-keyword">const</span> RESOLVE = <span class="hljs-string">'resolve'</span><br><span class="hljs-keyword">const</span> REJECT = <span class="hljs-string">'reject'</span><br><span class="hljs-keyword">const</span> handlePromise = <span class="hljs-function">(<span class="hljs-params">result, newPromise, resolve, reject</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span>(result === newPromise)&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'can not return oneself'</span>)<br>  &#125;<br>  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>) || <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>)&#123;<br>    <span class="hljs-keyword">let</span> lock = <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">try</span>&#123;<br>      <span class="hljs-keyword">const</span> then  = result.then<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> then === <span class="hljs-string">'function'</span>)&#123;<br>        then.call(<br>          result,<br>          r =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (lock) <span class="hljs-keyword">return</span><br>            handlePromise(r, newPromise, resolve, reject)<br>            lock = <span class="hljs-literal">true</span><br>          &#125;,<br>          e =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (lock) <span class="hljs-keyword">return</span><br>            reject(e)<br>            lock = <span class="hljs-literal">true</span><br>          &#125;)<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        resolve(then)<br>      &#125;<br>    &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>      reject(error)<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    resolve(result)<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypromise</span> </span>&#123;<br>  status = PENDING<br>  result = <span class="hljs-literal">undefined</span><br>  reason = <span class="hljs-literal">undefined</span><br>  onResolvedArr = []<br>  onRejectedArr = []<br>  <span class="hljs-keyword">constructor</span>(excution)&#123;<br>    <span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = RESOLVE<br>        <span class="hljs-keyword">this</span>.result = result<br>        <span class="hljs-keyword">this</span>.onResolvedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.status = REJECT<br>        <span class="hljs-keyword">this</span>.reason = reason<br>        <span class="hljs-keyword">this</span>.onRejectedArr.map(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> fn())<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">try</span>&#123;<br>      excution(resolve, reject)<br>    &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>      reject(error)<br>    &#125;<br>  &#125;<br>  then(onResolved, onRejected)&#123;<br>    onResolved = <span class="hljs-keyword">typeof</span> onResolved === <span class="hljs-string">'function'</span>? onResolved : <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> data<br>    onRejected = <span class="hljs-keyword">typeof</span> onRejected === <span class="hljs-string">'function'</span>? onRejected : <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(err)<br>    <span class="hljs-keyword">const</span> newPromise = <span class="hljs-keyword">new</span> Mypromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === RESOLVE)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === REJECT)&#123;<br>        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;  <br>        &#125;, <span class="hljs-number">0</span>)<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status === PENDING)&#123;<br>        <span class="hljs-keyword">this</span>.onResolvedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onResolved(<span class="hljs-keyword">this</span>.result)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;)<br>        <span class="hljs-keyword">this</span>.onRejectedArr.push(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> result = onRejected(<span class="hljs-keyword">this</span>.reason)<br>            handlePromise(result, newPromise, resolve, reject)<br>          &#125;<span class="hljs-keyword">catch</span>(error)&#123;<br>            reject(error)<br>          &#125;<br>        &#125;)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newPromise<br>  &#125;<br>  <span class="hljs-keyword">catch</span>(onRejected)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.then(<span class="hljs-literal">undefined</span>, onRejected)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>catch æ–¹æ³•æˆ‘ä»¬å¯ä»¥åŸºäº then æ–¹æ³•æ¥å®ç°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼  Undefinedï¼Œä½†æ˜¯è¿™æ—¶æˆ‘ä»¬è¿˜è¦åœ¨ then æ–¹æ³•ä¸­å¤„ç†ä¸€ä¸‹ä¼ å‚ä¸æ˜¯å‡½æ•°çš„æƒ…å†µ</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ä»£ç å°±å…¨éƒ¨å®ç°äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ã€‚</p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-é¡¹ç›®å®æˆ˜" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/10/13/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"
    >é¡¹ç›®å®æˆ˜</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/10/13/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" class="article-date">
  <time datetime="2020-10-13T03:28:53.000Z" itemprop="datePublished">2020-10-13</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/%E9%A1%B9%E7%9B%AE/">é¡¹ç›®</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="é€šè¿‡æƒé™ç æ¥æ§åˆ¶åŠ¨æ€è·¯ç”±"><a href="#é€šè¿‡æƒé™ç æ¥æ§åˆ¶åŠ¨æ€è·¯ç”±" class="headerlink" title="é€šè¿‡æƒé™ç æ¥æ§åˆ¶åŠ¨æ€è·¯ç”±"></a>é€šè¿‡æƒé™ç æ¥æ§åˆ¶åŠ¨æ€è·¯ç”±</h3><ul>
<li><p>é¡¹ç›®èƒŒæ™¯ï¼šè¿™æ˜¯ä¸€ä¸ªé€šè¿‡ç”¨æˆ·ç™»å½•æ¥è·å–ç”¨æˆ·æƒé™è·¯ç”±çš„ä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿã€‚å®ƒæ˜¯å»ºç«‹åœ¨ä¸€ä¸ªæ€»å¾—åå°ç®¡ç†ç³»ç»Ÿä¸‹çš„ä¸€ä¸ªTabé¡¹ï¼Œéœ€è¦ç™»å½•æ€»çš„åå°ç®¡ç†ç³»ç»Ÿä¹‹åé€šè¿‡ç•Œé¢ä¸Šæ¯ä¸ªåå°ç®¡ç†å…¥å£æ¥è¿›å…¥æˆ‘ä»¬çš„è¿™ä¸ªé‡‘å¸ç®¡ç†ç³»ç»Ÿã€‚æ¯ä¸ªäººç™»å½•æƒé™ä¸åŒï¼Œèƒ½å¤Ÿçœ‹åˆ°çš„é¡µé¢ä¹Ÿå°±ä¸åŒã€‚</p>
</li>
<li><p>é¡¹ç›®æ€è·¯ï¼šåœ¨æˆ‘ä»¬ç™»å½•æ€»çš„åå°ç®¡ç†ç³»ç»ŸæˆåŠŸä¹‹åï¼Œä¼šåœ¨cookieä¸­å­˜å‚¨ userIdã€ token , åœ¨é‡‘å¸ç®¡ç†ç³»ç»Ÿçš„ app.vue ä¸­æ¥è·å–è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®©é¡µé¢è·³è½¬åˆ°æ€»å¾—åå°ç®¡ç†ç³»ç»Ÿç™»å½•é¡µï¼Œå¼•å¯¼ç”¨æˆ·ç™»å½•ï¼Œå¦‚æœè·å–åˆ°å°±ä¼šè°ƒæ¥å£æ‹¿åˆ°è¯¥ç”¨æˆ·ä¸‹æ‰€æœ‰æƒé™ç ã€‚ä¹‹åæˆ‘ä»¬è°ƒç”¨vuexä¸­çš„æ–¹æ³• generateRoutes ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ä¸€ä¸ª</p>
</li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-æ·±æµ…æ‹·è´" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/09/29/%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/"
    >æ·±æµ…æ‹·è´</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/09/29/%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/" class="article-date">
  <time datetime="2020-09-29T09:28:44.000Z" itemprop="datePublished">2020-09-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„å˜é‡èµ‹å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¿®æ”¹åŸæ¥çš„å¯¹è±¡çš„å±æ€§å€¼ä¼šå¯¼è‡´æ–°èµ‹å€¼çš„è¿™ä¸ªå¯¹è±¡å±æ€§å€¼ä¹Ÿè·Ÿç€æ”¹å˜ï¼Œè¿™æ˜¯å› ä¸ºå¼•ç”¨ç±»å‹èµ‹å€¼å­˜å‚¨çš„æ˜¯å¼•ç”¨åœ°å€ï¼Œè¿™ä¸¤ä¸ªå˜é‡å…¶å®å¼•ç”¨çš„åŒä¸€ä¸ªæŒ‡é’ˆåœ°å€ï¼Œæ‰€ä»¥ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼ï¼Œä¸¤ä¸ªå˜é‡é‡Œçš„å±æ€§éƒ½ä¼šè·Ÿç€æ”¹å˜ã€‚ä¸‹é¢å°±è®©æˆ‘ä»¬çœ‹çœ‹æ·±æµ…æ‹·è´å¦‚ä½•è§£å†³è¿™ç±»é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'John'</span>,<br>  age: <span class="hljs-number">20</span><br>&#125;<br><span class="hljs-keyword">let</span> person = user<br>user.name = <span class="hljs-string">'Lucy'</span><br><span class="hljs-built_in">console</span>.log(person.name) <span class="hljs-comment">// Lucy</span><br></code></pre></td></tr></table></figure>

<h3 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'John'</span>,<br>  age: <span class="hljs-number">20</span><br>&#125;<br><span class="hljs-keyword">let</span> clone = &#123;&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> user)&#123;<br>  clone[key] = user[key]<br>&#125;<br>clone.name = <span class="hljs-string">'Lucy'</span><br><span class="hljs-built_in">console</span>.log(user.name) <span class="hljs-comment">// John</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'John'</span>,<br>  age: <span class="hljs-number">20</span><br>&#125;<br><span class="hljs-keyword">let</span> person = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, user)<br>user.name = <span class="hljs-string">'Lucy'</span><br><span class="hljs-built_in">console</span>.log(person.name) <span class="hljs-comment">// John</span><br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°ï¼Œåˆ©ç”¨ Object.assign() è¿˜æœ‰å¾ªç¯æˆ‘ä»¬å¯ä»¥è§£å†³å¯¹è±¡é‡Œé¢çš„å±æ€§å…±äº«çš„é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'John'</span>,<br>  age: <span class="hljs-number">20</span>,<br>  likeSports: [<span class="hljs-string">'swimming'</span>, <span class="hljs-string">'basketBall'</span>],<br>  child: &#123;<br>    name: <span class="hljs-string">'mini'</span>,<br>    age: <span class="hljs-number">2</span>,<br>    sex: <span class="hljs-string">'girl'</span><br>  &#125;<br>&#125;<br><span class="hljs-keyword">let</span> person = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, user)<br>user.likeSports.push(<span class="hljs-string">'shopping'</span>)<br>user.child.age = <span class="hljs-number">3</span><br><span class="hljs-built_in">console</span>.log(person.likeSports) <span class="hljs-comment">// ["swimming", "basketBall", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person.child.age) <span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure>
<p>å½“å¯¹è±¡å±æ€§å€¼ä¸ºå¼•ç”¨ç±»å‹æ—¶ï¼Œæˆ‘ä»¬æ”¹å˜å…¶å€¼ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨å±æ€§å€¼å…±äº«çš„é—®é¢˜ã€‚<br>è¿™ç§åªè§£å†³äº†ä¸€å±‚æ‹·è´çš„é—®é¢˜å°±æ˜¯æµ…æ‹·è´ã€‚</p>
<h3 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h3><p>æ·±æ‹·è´å°±å¯ä»¥è§£å†³å¤šå±‚å¼•ç”¨ç±»å‹çš„æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ JSON.parse(JSON.stringify(object)) æ¥è§£å†³</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'John'</span>,<br>  child: &#123;<br>    name: <span class="hljs-string">'mini'</span>,<br>    age: <span class="hljs-number">2</span><br>  &#125;<br>&#125;<br><span class="hljs-keyword">let</span> person = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(user))<br>user.child.age = <span class="hljs-number">3</span><br><span class="hljs-built_in">console</span>.log(person.child.age) <span class="hljs-comment">// 2</span><br></code></pre></td></tr></table></figure>
<p>å¯æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ä¸å®Œç¾çš„ï¼Œå®ƒæœ‰å±€é™æ€§</p>
<ul>
<li>ä¼šå¿½ç•¥ undefined å’Œ Symbol</li>
<li>ä¸èƒ½åºåˆ—åŒ–å‡½æ•°</li>
<li>ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨å¯¹è±¡</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> obj = &#123;<br>  a: <span class="hljs-number">1</span>,<br>  b: &#123;<br>    c: <span class="hljs-number">2</span>,<br>    d: <span class="hljs-number">3</span><br>  &#125;<br>&#125;<br>obj.c = obj.b<br>obj.e = obj.a<br>obj.b.c = obj.c<br>obj.b.d = obj.b<br>obj.b.e = obj.b.c<br><span class="hljs-keyword">let</span> newObj = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(obj))<br><span class="hljs-built_in">console</span>.log(newObj)<br><br><span class="hljs-comment">// VM3724:13 Uncaught TypeError: Converting circular structure to JSON</span><br><span class="hljs-comment">//     --&gt; starting at object with constructor 'Object'</span><br><span class="hljs-comment">//     --- property 'c' closes the circle</span><br><span class="hljs-comment">//     at JSON.stringify (&lt;anonymous&gt;)</span><br><span class="hljs-comment">//     at &lt;anonymous&gt;:13:30</span><br></code></pre></td></tr></table></figure>
<p>å¦‚æœè¿™æ ·å¾ªç¯å¼•ç”¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>åœ¨é‡åˆ° Symbolã€undefined çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä¹Ÿä¸èƒ½æ­£å¸¸çš„åºåˆ—åŒ–</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'Lucy'</span>,<br>  age: <span class="hljs-built_in">Symbol</span>(<span class="hljs-number">20</span>),<br>  like: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;&#125;,<br>  sex: <span class="hljs-literal">undefined</span><br>&#125;<br><span class="hljs-keyword">let</span> person = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(user))<br><span class="hljs-built_in">console</span>.log(person) <span class="hljs-comment">// &#123;name: "Lucy"&#125;</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šé¢è¿™æ®µä»£ç æœ€åæˆ‘ä»¬åªæ‹·è´è¿‡æ¥ name å±æ€§ï¼Œå…¶å®ƒçš„éƒ½è¢«å¿½ç•¥äº†</p>
<h3 id="å®ç°ä¸€ä¸ªç®€å•çš„æ·±æ‹·è´"><a href="#å®ç°ä¸€ä¸ªç®€å•çš„æ·±æ‹·è´" class="headerlink" title="å®ç°ä¸€ä¸ªç®€å•çš„æ·±æ‹·è´"></a>å®ç°ä¸€ä¸ªç®€å•çš„æ·±æ‹·è´</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepClone</span>(<span class="hljs-params">obj</span>)</span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isObject</span>(<span class="hljs-params">o</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">typeof</span> o == <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> o == <span class="hljs-string">'function'</span>) &amp;&amp; o !== <span class="hljs-literal">null</span>)<br>  &#125;<br>  <span class="hljs-keyword">if</span>(!isObject(obj))&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡'</span>)<br>  &#125;<br>  <span class="hljs-keyword">let</span> isArray = <span class="hljs-built_in">Array</span>.isArray(obj)<br>  <span class="hljs-keyword">let</span> newObj = isArray? [...obj] : &#123;...obj&#125;<br>  <span class="hljs-built_in">Reflect</span>.ownKeys(newObj).forEach(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>    newObj[key] = isObject(obj[key])? deepClone(obj[key]) : obj[key]<br>  &#125;)<br>  <span class="hljs-keyword">return</span> newObj<br>&#125;<br><br><span class="hljs-keyword">let</span> user = &#123;<br>  name: <span class="hljs-string">'Lucy'</span>,<br>  age: <span class="hljs-number">20</span>,<br>  child: &#123;<br>    name: <span class="hljs-string">'mini'</span>,<br>    likeFood: [<span class="hljs-string">'banana'</span>, <span class="hljs-string">'apple'</span>],<br>    sex: <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">'girl'</span>),<br>    can: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;&#125;,<br>    hobby: <span class="hljs-literal">undefined</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> person = deepClone(user)<br><br>user.child.likeFood.push(<span class="hljs-string">'pear'</span>)<br><span class="hljs-built_in">console</span>.log(person.child.likeFood) <span class="hljs-comment">// ["banana", "apple"]</span><br></code></pre></td></tr></table></figure>
      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-æ£€æµ‹æ•°æ®ç±»å‹-md" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/09/28/%E6%A3%80%E6%B5%8B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-md/"
    >æ£€æµ‹æ•°æ®ç±»å‹.md</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/09/28/%E6%A3%80%E6%B5%8B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-md/" class="article-date">
  <time datetime="2020-09-28T13:00:30.000Z" itemprop="datePublished">2020-09-28</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;åœ¨æˆ‘ä»¬å¹³æ—¶å¼€å‘çš„è¿‡ç¨‹ä¸­ç»å¸¸ä¼šéœ€è¦æ£€æµ‹æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆJSä¸­æ£€æµ‹æ•°æ®ç±»å‹çš„æ–¹å¼æœ‰å‡ ç§å‘¢ï¼Œå®ƒä»¬ä¹‹é—´éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬æ·±å…¥çš„ç ”ç©¶ä¸€ä¸‹å§ï¼</p>
<h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><p>typeofå¯¹äºåŸå§‹æ•°æ®ç±»å‹æ¥è¯´é™¤äº†nullä»¥å¤–ï¼Œå…¶å®ƒçš„éƒ½èƒ½æ­£ç¡®æ£€æµ‹å‡ºæ¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-number">11n</span>) <span class="hljs-comment">// "bigint"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-number">11</span>) <span class="hljs-comment">// "bigint"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-string">''</span>) <span class="hljs-comment">// "string"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">undefined</span>) <span class="hljs-comment">// "undefined"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">true</span>) <span class="hljs-comment">// "boolean"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span>()) <span class="hljs-comment">// "symbol"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>) <span class="hljs-comment">// "object"</span><br></code></pre></td></tr></table></figure>
<ul>
<li><p>ç”¨ typeof æ£€æµ‹æ•°æ®ç±»å‹ï¼Œç»“æœéƒ½ä¼šæ”¾åœ¨å­—ç¬¦ä¸²ä¸­è¿”å›æ¥ã€‚</p>
</li>
<li><p>é€šè¿‡ä¸Šé¢çš„ä¸€äº›ä¾‹å­æˆ‘ä»¬å‘ç°ï¼Œ typeof æ£€æµ‹ null æ—¶è¿”å›çš„æ˜¯ â€œobjectâ€ æ•°æ®ç±»å‹ï¼Œè¿™ä¸æˆ‘ä»¬æ‰€é¢„æœŸçš„ç»“æœä¸å¤ªä¸€æ ·ã€‚è€Œè¿™æ˜¯JSå†å²é—ç•™çš„é—®é¢˜ï¼Œæˆ‘ä»¬åªè¦è®°ä½ç”¨ type æ£€æµ‹åŸå§‹æ•°æ®ç±»å‹ä¼šå­˜åœ¨è¿™ä¸ªå‘å°±å¯ä»¥äº†ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ç”¨ typeof æ£€æµ‹å¼•ç”¨æ•°æ®ç±»å‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> []) <span class="hljs-comment">// "object"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> &#123;&#125;) <span class="hljs-comment">// "object"</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">console</span>.log) <span class="hljs-comment">// "function"</span><br></code></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„å‡ ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ typeof æ£€æµ‹å¼•ç”¨æ•°æ®ç±»å‹ï¼Œé™¤äº†å‡½æ•°ä»¥å¤–ï¼Œå…¶å®ƒçš„éƒ½ä¼šè¿”å› â€œobjectâ€</p>
<p>æ‰€ä»¥ typeof å¹¶ä¸èƒ½å‡†ç¡®çš„åˆ¤æ–­å˜é‡æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Œä½†æ˜¯æ ¹æ®æˆ‘ä»¬å®é™…å¼€å‘æƒ…å†µä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ã€‚</p>
<h3 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h3><p>instanceof çš„å†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åŸå‹é“¾æ¥è¿›è¡Œåˆ¤æ–­çš„ã€‚ç”¨æ¥æ£€æµ‹æŸä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºæŸä¸ªç±»ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params"></span>)</span>&#123;&#125;<br><span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> Person()<br>person <span class="hljs-keyword">instanceof</span> Person <span class="hljs-comment">// true</span><br>person <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span> <span class="hljs-comment">// true</span><br><br><span class="hljs-keyword">const</span> str = <span class="hljs-string">'Hello world'</span><br>str <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">String</span> <span class="hljs-comment">// false</span><br><br><span class="hljs-keyword">const</span> str1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">'hello world'</span>)<br>str1 <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">String</span> <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>
<ul>
<li><p>é€šè¿‡ instanceof æ£€æµ‹æ•°æ®ç±»å‹ä¼šè¿”å›ä¸€ä¸ª Boole å€¼</p>
</li>
<li><p>åªè¦åœ¨å½“å‰å®ä¾‹çš„åŸå‹é“¾ä¸Šï¼Œæˆ‘ä»¬ç”¨å…¶æ£€æµ‹å‡ºæ¥çš„ç»“æœéƒ½ä¸ºtrue</p>
</li>
<li><p>ä¸èƒ½ç”¨æ¥æ£€æµ‹å’Œå¤„ç†å­—é¢é‡æ–¹å¼åˆ›å»ºå‡ºæ¥çš„åŸºæœ¬æ•°æ®ç±»å‹å€¼</p>
</li>
</ul>
<p>ç”¨ instance æ£€æµ‹ä¹Ÿä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®å¼€å‘éœ€è¦æ¥è¿›è¡Œé€‰æ‹©ã€‚</p>
<h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><p>constructor æ˜¯åˆ©ç”¨æ„é€ å‡½æ•°æ¥æ£€æµ‹æ•°æ®ç±»å‹çš„ï¼Œä½†æ˜¯å¯¹äº null å’Œ undefined æ˜¯æ£€æµ‹ä¸å‡ºæ¥çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">''</span><br>str.constructor === <span class="hljs-built_in">String</span> <span class="hljs-comment">// true</span><br><br><span class="hljs-keyword">const</span> num = <span class="hljs-number">2</span><br>num.constructor === <span class="hljs-built_in">Number</span> <span class="hljs-comment">// true</span><br><br><span class="hljs-literal">null</span>.constructor === Null <span class="hljs-comment">// Uncaught TypeError: Cannot read property 'constructor' of null</span><br><br><span class="hljs-keyword">const</span> obj = &#123;&#125;<br>obj.constructor === <span class="hljs-built_in">Object</span> <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>
<ul>
<li><p>constructor å’Œ instanceof çš„åŠŸèƒ½å·®ä¸å¤š</p>
</li>
<li><p>constructor å¯ä»¥å¤„ç†åŸºæœ¬ç±»å‹çš„æ£€æµ‹</p>
</li>
</ul>
<h3 id="Object-prototype-toString-call"><a href="#Object-prototype-toString-call" class="headerlink" title="Object.prototype.toString.call()"></a>Object.prototype.toString.call()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-string">''</span>) <span class="hljs-comment">// "[object String]"</span><br><span class="hljs-built_in">Object</span>.prototype.toString.call(&#123;&#125;) <span class="hljs-comment">// "[object Object]"</span><br><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-number">123</span>) <span class="hljs-comment">// "[object Number]"</span><br><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-literal">null</span>) <span class="hljs-comment">// "[object Null]"</span><br><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-literal">undefined</span>) <span class="hljs-comment">// "[object Undefined]"</span><br><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-built_in">console</span>.log) <span class="hljs-comment">// "[object Function]"</span><br></code></pre></td></tr></table></figure>
<ul>
<li><p>è¿™æ˜¯åˆ°ç›®å‰ä¸ºæ­¢æ£€æµ‹æ•°æ®ç±»å‹æœ€å‡†ç¡®çš„ä¸€ç§æ–¹å¼</p>
</li>
<li><p>æ£€æµ‹ç»“æœçš„ç¬¬ä¸€ä¸ª object ä»£è¡¨å½“å‰å®ä¾‹æ˜¯å¯¹è±¡æ•°æ®ç±»å‹çš„ï¼ˆè¿™ä¸ªæ˜¯å›ºå®šæ­»çš„ï¼‰ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯æˆ‘ä»¬æ‰€è¦æ£€æµ‹çš„æ•°æ®ç±»å‹ã€‚</p>
</li>
</ul>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ä»¥ä¸Š4ç§å°±æ˜¯é¡¹ç›®ä¸­æˆ‘ä»¬å¯èƒ½ä¼šç”¨åˆ°çš„æ£€æµ‹æ•°æ®ç±»å‹çš„æ–¹æ³•ã€‚</p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-inherit" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/09/25/inherit/"
    >jsä¸­çš„ç»§æ‰¿</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/09/25/inherit/" class="article-date">
  <time datetime="2020-09-25T11:58:31.000Z" itemprop="datePublished">2020-09-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="1ã€åŸå‹é“¾ç»§æ‰¿"><a href="#1ã€åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="1ã€åŸå‹é“¾ç»§æ‰¿"></a>1ã€åŸå‹é“¾ç»§æ‰¿</h3><ul>
<li>åŸç†ï¼šåŸå‹é“¾å¯¹è±¡å˜æˆçˆ¶ç±»çš„å®ä¾‹ï¼Œå­ç±»å°±å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§ï¼ˆåˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ï¼‰<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params"></span>)</span>&#123; &#125;<br><br>Parent.prototype.age = <span class="hljs-number">13</span><br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.name = name<br>&#125;<br><br>Child.prototype = <span class="hljs-keyword">new</span> Parent()<br><br><span class="hljs-keyword">let</span> child = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'AmilyCi'</span>)<br><br><span class="hljs-built_in">console</span>.log(child.age) <span class="hljs-comment">// 13</span><br><span class="hljs-built_in">console</span>.log(child.getName()) <span class="hljs-comment">// 'AmilyCi'</span><br></code></pre></td></tr></table></figure></li>
<li>ä¼˜ç‚¹ï¼šå®ç°èµ·æ¥ç®€å•</li>
<li>ç¼ºç‚¹ï¼šä¸èƒ½å‘çˆ¶ç±»ä¼ é€’å‚æ•°ï¼Œå¼•ç”¨ç±»å‹çš„å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>&#125;<br><br>Parent.prototype.age = <span class="hljs-number">13</span><br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.name = name<br>&#125;<br><br>Child.prototype = <span class="hljs-keyword">new</span> Parent()<br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'AmilyCx'</span>)<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Json'</span>)<br><br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br></code></pre></td></tr></table></figure>
<p>ä½ ä¼šå‘ç°ï¼Œå½“æˆ‘ä»¬ç»™ person1 å¢åŠ ä¸€ä¸ªå–œæ¬¢çš„è¿åŠ¨æ—¶ï¼Œæˆ‘ä»¬æ‰“å°å‡º person2 å–œæ¬¢çš„è¿åŠ¨ï¼Œè¿™æ—¶å€™ person2 çš„å–œæ¬¢è¿åŠ¨ä¸­ä¹Ÿå¢åŠ äº†è¿™ä¸ªè¿åŠ¨ã€‚è¿™ä¸ªå±æ€§ä¼šè¢«æ‰€æœ‰çš„å®ä¾‹å…±äº«ã€‚</p>
<h3 id="2ã€æ„é€ å‡½æ•°ç»§æ‰¿"><a href="#2ã€æ„é€ å‡½æ•°ç»§æ‰¿" class="headerlink" title="2ã€æ„é€ å‡½æ•°ç»§æ‰¿"></a>2ã€æ„é€ å‡½æ•°ç»§æ‰¿</h3><ul>
<li>åŸç†ï¼šå­ç±»æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¹¶ä¼ å…¥this<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.name = name<br>  <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  Parent.call(<span class="hljs-keyword">this</span>, name)<br>&#125;<br><br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lucy'</span>)<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'LiLy'</span>)<br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming"]</span><br><span class="hljs-built_in">console</span>.log(person1.name) <span class="hljs-comment">// Lucy</span><br><span class="hljs-built_in">console</span>.log(person1.getName()) <span class="hljs-comment">// Uncaught TypeError: person1.getName is not a function</span><br></code></pre></td></tr></table></figure>
è¿™æ¬¡ï¼Œæˆ‘ä»¬é€šè¿‡ call æ–¹æ³•ï¼Œå¯ä»¥ç»™çˆ¶ç±»ä¼ å‚å•¦ï¼Œå¹¶ä¸”æˆ‘ä»¬ç»™ person1 å¢åŠ ä¸€é¡¹å–œæ¬¢çš„è¿åŠ¨ï¼Œperson2 ä¸ä¼šä¹Ÿè¢«åŠ ä¸Šå•¦ã€‚<br>ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬åˆ›å»ºçš„å®ä¾‹å¹¶ä¸èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•äº†ï¼Œä¼šæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç°åœ¨ç”¨çš„æ„é€ å‡½æ•°æ–¹å¼å¯¼è‡´çˆ¶ç±»å¹¶ä¸åœ¨å­ç±»çš„åŸå‹é“¾ä¸Šï¼Œæ‰€ä»¥å­ç±»æ— æ³•è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚</li>
</ul>
<h3 id="3ã€ç»„åˆç»§æ‰¿"><a href="#3ã€ç»„åˆç»§æ‰¿" class="headerlink" title="3ã€ç»„åˆç»§æ‰¿"></a>3ã€ç»„åˆç»§æ‰¿</h3><ul>
<li>åŸç†ï¼šç»“åˆäº†å‰ä¸¤ä¸ªæ–¹æ³•çš„ä¼˜ç‚¹</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.name = name<br>  <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>&#125;<br><br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name, age</span>)</span>&#123;<br>  Parent.call(<span class="hljs-keyword">this</span>, name)<br>  <span class="hljs-keyword">this</span>.age = age<br>&#125;<br><br>Child.prototype = <span class="hljs-keyword">new</span> Parent()<br>Child.prototype.constructor = Child<br>Child.prototype.getAge = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age<br>&#125;<br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lucy'</span>, <span class="hljs-number">18</span>)<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lily'</span>, <span class="hljs-number">20</span>)<br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming"]</span><br><span class="hljs-built_in">console</span>.log(person1.name) <span class="hljs-comment">// Lucy</span><br><span class="hljs-built_in">console</span>.log(person1.getAge()) <span class="hljs-comment">// 18</span><br><span class="hljs-built_in">console</span>.log(person1.getName()) <span class="hljs-comment">// Lucy</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬è§£å†³äº†ä¼ å‚çš„é—®é¢˜ï¼Œå¼•ç”¨ç±»å‹çš„å±æ€§å…±äº«çš„é—®é¢˜ï¼Œè¿˜æœ‰è°ƒç”¨çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•çš„é—®é¢˜éƒ½è§£å†³äº†ã€‚<br>ä½†æ˜¯ç°åœ¨è¿˜æœ‰ä¸€ä¸ªä¸è¶³ä¹‹å¤„ï¼Œåœ¨ç»™ Child åŸå‹èµ‹å€¼çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ— è®ºä»€ä¹ˆæƒ…å†µä¸‹éƒ½ä¼šè°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°</p>
<h3 id="4ã€å¯„ç”Ÿç»„åˆç»§æ‰¿"><a href="#4ã€å¯„ç”Ÿç»„åˆç»§æ‰¿" class="headerlink" title="4ã€å¯„ç”Ÿç»„åˆç»§æ‰¿"></a>4ã€å¯„ç”Ÿç»„åˆç»§æ‰¿</h3><ul>
<li>åŸç†ï¼šé¦–å…ˆç”¨ä¸€ä¸ªç©ºå¯¹è±¡å»ºç«‹å’Œçˆ¶ç±»çš„å…³ç³»ï¼Œå†ç”¨è¿™ä¸ªç©ºå¯¹è±¡ä½œä¸ºå­ç±»çš„åŸå‹å¯¹è±¡</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inheritProtype</span>(<span class="hljs-params">child,parent</span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> prototype = <span class="hljs-built_in">Object</span>.create(parent.prototype);<span class="hljs-comment">// åˆ›å»ºå¯¹è±¡</span><br>    prototype.constructor = child;<br>    child.prototype = prototype<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">name</span>) </span>&#123;<br>    <span class="hljs-keyword">this</span>.name = name<br>    <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>&#125;<br><br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name,age</span>)</span>&#123;<br>    Parent.call(<span class="hljs-keyword">this</span>,name);<br>    <span class="hljs-keyword">this</span>.age = age;<br>&#125;<br>inheritProtype(Child,Parent);<br><br>Child.prototype.getAge = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age<br>&#125; <br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Keven'</span>,<span class="hljs-number">13</span>);<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lucy'</span>,<span class="hljs-number">15</span>);<br><br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming"]</span><br><span class="hljs-built_in">console</span>.log(person1.name) <span class="hljs-comment">// "Keven"</span><br><span class="hljs-built_in">console</span>.log(person1.getName()) <span class="hljs-comment">// Keven</span><br><span class="hljs-built_in">console</span>.log(person1.getAge()) <span class="hljs-comment">// 13</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">name</span>)</span>&#123;<br>  <span class="hljs-keyword">this</span>.name = name<br>  <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>&#125;<br>Parent.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">name, age</span>)</span>&#123;<br>  Parent.call(<span class="hljs-keyword">this</span>, name)<br>  <span class="hljs-keyword">this</span>.age = age<br>&#125;<br>Child.prototype = <span class="hljs-built_in">Object</span>.create(Parent.prototype, &#123;<br>  <span class="hljs-keyword">constructor</span>: &#123;<br>    value: Child,<br>    enumerable: <span class="hljs-literal">false</span>,<br>    configurable: <span class="hljs-literal">true</span>,<br>    writable: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;)<br>Child.prototype.getAge = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age<br>&#125;<br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Keven'</span>,<span class="hljs-number">13</span>);<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lucy'</span>,<span class="hljs-number">15</span>);<br><br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming"]</span><br><span class="hljs-built_in">console</span>.log(person1.name)  <span class="hljs-comment">// Keven</span><br><span class="hljs-built_in">console</span>.log(person1.getName()) <span class="hljs-comment">// Keven</span><br><span class="hljs-built_in">console</span>.log(person1.getAge()) <span class="hljs-comment">//13</span><br></code></pre></td></tr></table></figure>

<p>è§£å†³çˆ¶ç±»è¢«è°ƒç”¨ä¸¤æ¬¡çš„æƒ…å†µï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼</p>
<h3 id="5ã€classç»§æ‰¿"><a href="#5ã€classç»§æ‰¿" class="headerlink" title="5ã€classç»§æ‰¿"></a>5ã€classç»§æ‰¿</h3><ul>
<li>ES6ä¸ºæˆ‘ä»¬æä¾›äº† classã€ extends å…³é”®å­—å¯ä»¥è½»æ¾çš„å®ç°ä¸Šé¢é‚£ç§ç»§æ‰¿æ–¹å¼<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span> </span>&#123;<br>  <span class="hljs-keyword">constructor</span>(name, age)&#123;<br>    <span class="hljs-keyword">this</span>.name = name<br>    <span class="hljs-keyword">this</span>.age = age<br>    <span class="hljs-keyword">this</span>.likeSports = [<span class="hljs-string">'badminton'</span>, <span class="hljs-string">'basketball'</span>, <span class="hljs-string">'swimming'</span>]<br>  &#125;<br>  getName()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name<br>  &#125;<br>  getAge()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age<br>  &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Parent</span></span>&#123;<br>  <span class="hljs-keyword">constructor</span>(name, age)&#123;<br>    <span class="hljs-keyword">super</span>(name,age)<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> person1 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lucy'</span>, <span class="hljs-number">28</span>)<br><span class="hljs-keyword">let</span> person2 = <span class="hljs-keyword">new</span> Child(<span class="hljs-string">'Lily'</span>, <span class="hljs-number">30</span>)<br><br>person1.likeSports.push(<span class="hljs-string">'shopping'</span>)<br><br><span class="hljs-built_in">console</span>.log(person1.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming", "shopping"]</span><br><span class="hljs-built_in">console</span>.log(person2.likeSports) <span class="hljs-comment">// ["badminton", "basketball", "swimming"]</span><br><span class="hljs-built_in">console</span>.log(person1.name) <span class="hljs-comment">// Lucy</span><br><span class="hljs-built_in">console</span>.log(person1.getName()) <span class="hljs-comment">// Lucy</span><br><span class="hljs-built_in">console</span>.log(person2.getAge()) <span class="hljs-comment">// 30</span><br></code></pre></td></tr></table></figure></li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-closure" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/09/01/closure/"
    >é—­åŒ…</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/09/01/closure/" class="article-date">
  <time datetime="2020-09-01T09:12:13.000Z" itemprop="datePublished">2020-09-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="ä»€ä¹ˆæ˜¯é—­åŒ…"><a href="#ä»€ä¹ˆæ˜¯é—­åŒ…" class="headerlink" title="ä»€ä¹ˆæ˜¯é—­åŒ…"></a>ä»€ä¹ˆæ˜¯é—­åŒ…</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ä¸€ä¸ªå‡½æ•°Aä¸­åŒ…å«å¦ä¸€ä¸ªå‡½æ•°Bï¼Œå‡½æ•°Bå¯ä»¥è·å–å‡½æ•°Aä¸­çš„å˜é‡ï¼Œå‡½æ•°Bå°±æ˜¯é—­åŒ…ã€‚é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬åœ¨å­ä½œç”¨åŸŸä¸­å¯ä»¥è·å–çˆ¶ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦ä»çˆ¶ä½œç”¨åŸŸä¸­è·å–å­ä½œç”¨åŸŸä¸­çš„å˜é‡è¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åŒ…ï¼Œè¿”å›å­ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å–äº†ã€‚</p>
<blockquote>
<p>ç®€è¿°ï¼šé—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> a = <span class="hljs-number">3</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">father</span>(<span class="hljs-params">x</span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> b = <span class="hljs-number">1</span> + x;<br>  <span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'b'</span>, b) <span class="hljs-comment">// b 6</span><br>  &#125;)()<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'a'</span>, a) <span class="hljs-comment">// a 3</span><br>father(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­è·å–å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡bäº†ã€‚</p>
<h3 id="é—­åŒ…å®ä¾‹"><a href="#é—­åŒ…å®ä¾‹" class="headerlink" title="é—­åŒ…å®ä¾‹"></a>é—­åŒ…å®ä¾‹</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br></code></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€é“ç»å…¸çš„é¢è¯•é¢˜ï¼Œæ§åˆ¶å°ä¾æ¬¡ä¼šè¾“å‡ºä»€ä¹ˆï¼Œæ­£ç¡®ç­”æ¡ˆä¸ºï¼š5ï¼Œ5ï¼Œ5ï¼Œ5ï¼Œ5ï¼Œ5å‡å¦‚ç”¨â€™-&gt;â€™è¡¨ç¤ºä¸ºéš”ä¸€ç§’é’Ÿï¼Œç”¨â€™,â€™è¡¨ç¤ºä¸é—´éš”ï¼Œé‚£ä¹ˆæ€ä¹ˆå½¢å®¹æ§åˆ¶å°çš„è¾“å‡ºå‘¢ï¼Ÿç­”æ¡ˆä¸ºï¼š5-&gt;5,5,5,5,5ï¼Œæ˜¯çš„ï¼Œæ§åˆ¶å°ä¼šå…ˆè¾“å‡ºä¸€ä¸ª5ï¼Œä¹‹åè¿‡äº†ä¸€ç§’é’Ÿä¼šè¿ç»­è¾“å‡ºäº”ä¸ª5ã€‚<br>é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¾“å‡ºï¼š5ï¼Œ0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4å‘¢ï¼Ÿ<br>åœ¨å¾ªç¯æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹åŒæ—¶è®¾ç½®äº†5ä¸ªå®šæ—¶å™¨ï¼Œè¿™äº›å®šæ—¶å™¨ä¼šåœ¨ä¸€ç§’ä¹‹åè§¦å‘ï¼Œè€Œå¾ªç¯ä¹‹åçš„è¾“å‡ºæ˜¯ç«‹å³æ‰§è¡Œçš„ã€‚<br>å¦‚æœæˆ‘ä»¬æƒ³è®©è¾“å‡ºå˜ä¸º5-&gt;0,1,2,3,4ï¼Œé‚£åº”è¯¥æ€ä¹ˆæ”¹å†™ä»£ç å‘¢ï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">j</span>)</span>&#123;<br>    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, j)<br>    &#125;, <span class="hljs-number">1000</span>)<br>  &#125;)(i)<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br></code></pre></td></tr></table></figure>
<p>æˆ–è€…å¯ä»¥ç”¨å¦ä¸€ä¸ªåŠæ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">j</span>)</span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, j)<br>  &#125;, <span class="hljs-number">1000</span>, i)<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br></code></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ä¸ªæœ€ç®€å•å¾—åŠæ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br></code></pre></td></tr></table></figure>
<p>ä»¥ä¸Šçš„å‡ ä¸ªæ–¹æ³•éƒ½å¯ä»¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦å¾—ç»“æœ</p>
<p>ç°åœ¨å¦‚æœæˆ‘ä»¬æƒ³è¦è¾“å‡ºå¾—ç»“æœä¸ºï¼š0-&gt;1-&gt;2-&gt;3-&gt;4-&gt;5,é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ”¹å†™å‘¢</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">j</span>)</span>&#123;<br>    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, j)<br>    &#125;, <span class="hljs-number">1000</span> * j)<br>  &#125;)(i)<br>&#125;<br>setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>&#125;, <span class="hljs-number">1000</span> * i)<br></code></pre></td></tr></table></figure>
<p>è¿™æ˜¯æœ€ç®€å•ç›´æ¥å¾—æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¼‚æ­¥å¾—Promiseæ¥å®Œæˆ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tasks = []<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  (<span class="hljs-function">(<span class="hljs-params">j</span>) =&gt;</span> &#123;<br>    tasks.push(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, j)<br>        resolve()<br>      &#125;, <span class="hljs-number">1000</span> * j)<br>    &#125;))<br>  &#125;)(i)<br>&#125;<br><span class="hljs-built_in">Promise</span>.all(tasks).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šçš„ä»£ç å¯ä»¥ç®€å†™ä¸ºä¸‹é¢è¿™ç§æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tasks = []<br><span class="hljs-keyword">const</span> output = <span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>    resolve()<br>  &#125;, <span class="hljs-number">1000</span> * i)<br> &#125;)<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>  tasks.push(output(i))<br>&#125;<br><span class="hljs-built_in">Promise</span>.all(tasks).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ä½¿ç”¨async/awaitæ¥å®ç°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sleep = <span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>  setTimeout(resolve,time)<br>&#125;)<br>(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>    <span class="hljs-keyword">if</span>(i &gt; <span class="hljs-number">0</span>)&#123;<br>      <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">1000</span>)<br>    &#125;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>  &#125;<br>  <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">1000</span>)<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>, i)<br>&#125;)()<br></code></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨é—­åŒ…åº”è¯¥æ³¨æ„çš„ç‚¹"><a href="#ä½¿ç”¨é—­åŒ…åº”è¯¥æ³¨æ„çš„ç‚¹" class="headerlink" title="ä½¿ç”¨é—­åŒ…åº”è¯¥æ³¨æ„çš„ç‚¹"></a>ä½¿ç”¨é—­åŒ…åº”è¯¥æ³¨æ„çš„ç‚¹</h3><ul>
<li><p>ç”±äºé—­åŒ…ä¼šä½¿å¾—å‡½æ•°ä¸­çš„å˜é‡éƒ½è¢«ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜æ¶ˆè€—å¾ˆå¤§ï¼Œæ‰€ä»¥ä¸èƒ½æ»¥ç”¨é—­åŒ…ï¼Œå¦åˆ™ä¼šé€ æˆç½‘é¡µçš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨IEä¸­å¯èƒ½å¯¼è‡´å†…å­˜æ³„éœ²ã€‚è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨é€€å‡ºå‡½æ•°ä¹‹å‰ï¼Œå°†ä¸ä½¿ç”¨çš„å±€éƒ¨å˜é‡å…¨éƒ¨åˆ é™¤ã€‚</p>
</li>
<li><p>é—­åŒ…ä¼šåœ¨çˆ¶å‡½æ•°å¤–éƒ¨ï¼Œæ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æŠŠçˆ¶å‡½æ•°å½“ä½œå¯¹è±¡ï¼ˆobjectï¼‰ä½¿ç”¨ï¼ŒæŠŠé—­åŒ…å½“ä½œå®ƒçš„å…¬ç”¨æ–¹æ³•ï¼ˆPublic Methodï¼‰ï¼ŒæŠŠå†…éƒ¨å˜é‡å½“ä½œå®ƒçš„ç§æœ‰å±æ€§ï¼ˆprivate valueï¼‰ï¼Œè¿™æ—¶ä¸€å®šè¦å°å¿ƒï¼Œä¸è¦éšä¾¿æ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼</p>
</li>
</ul>
<h3 id="é—­åŒ…ç›¸å…³çš„æ–‡ç« "><a href="#é—­åŒ…ç›¸å…³çš„æ–‡ç« " class="headerlink" title="é—­åŒ…ç›¸å…³çš„æ–‡ç« "></a>é—­åŒ…ç›¸å…³çš„æ–‡ç« </h3><ul>
<li>å¸å¾’æ­£ç¾ï¼š<a href="https://www.cnblogs.com/rubylouvre/p/3345294.html" target="_blank" rel="noopener">https://www.cnblogs.com/rubylouvre/p/3345294.html</a></li>
<li>é˜®ä¸€å³°ï¼š<a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html</a></li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-throttle" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/08/17/throttle/"
    >èŠ‚æµä¸é˜²æŠ–</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/08/17/throttle/" class="article-date">
  <time datetime="2020-08-17T12:20:30.000Z" itemprop="datePublished">2020-08-17</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">æ€§èƒ½ä¼˜åŒ–</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;èŠ‚æµå’Œé˜²æŠ–æ˜¯æˆ‘ä»¬å¹³å¸¸å¼€å‘ç»å¸¸ä¼šç”¨åˆ°çš„æ€§èƒ½ä¼˜åŒ–ä¹‹ä¸€ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨æ¥é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œç”¨æ¥ä¼˜åŒ–å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜å¯¼è‡´çš„å“åº”é€Ÿåº¦è·Ÿä¸ä¸Šï¼Œå»¶è¿Ÿå‡æ­»æˆ–å¡é¡¿çš„ç°è±¡ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬æ¥è¯¦ç»†çš„åˆ†æä¸€ä¸‹æ€æ ·æ¥åšèŠ‚æµä¸é˜²æŠ–ã€‚</p>
<h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å‡½æ•°çš„é˜²æŠ–å°±æ˜¯åœ¨ä¸€å®šæ—¶é—´å†…å¦‚æœæŸä¸ªäº‹ä»¶è¢«é«˜é¢‘çš„è§¦å‘,é‚£ä¹ˆæˆ‘ä»¬å°±å»¶æ—¶è®©ä»–æ‰§è¡Œï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ—¶é—´ä¸º3sï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è§¦å‘è¡Œä¸ºæ—¶ï¼Œè®¡æ—¶å™¨å¼€å§‹è®¡æ—¶ï¼Œå¦‚æœåœ¨å€’è®¡æ—¶æ—¶é—´å†…æ²¡æœ‰å†æ¬¡è§¦å‘è¡Œä¸ºï¼Œé‚£ä¹ˆè®¡æ—¶ç»“æŸåä¼šæ‰§è¡Œå‡½æ•°ï¼Œä½†æ˜¯åœ¨è®¡æ—¶æ—¶é—´å†…å¦‚æœåˆè§¦å‘äº†è¯¥è¡Œä¸ºï¼Œåˆ™è®¡æ—¶å™¨å¼€å§‹é‡æ–°è®¡æ—¶ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå…¶å®é˜²æŠ–å°±æ˜¯åœ¨è§¦å‘é«˜é¢‘ç‡çš„è¡Œä¸ºæ—¶åªæ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼Œè¿™æ ·é€šè¿‡æ§åˆ¶æ¬¡æ•°æ¥æé«˜æ€§èƒ½ã€‚</p>
<blockquote>
<p>ç®€è¿°ï¼šäº‹ä»¶è§¦å‘nç§’åè¢«æ‰§è¡Œå›è°ƒï¼Œå¦‚æœnç§’å†…å†æ¬¡è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶</p>
</blockquote>
<p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ»šåŠ¨äº‹ä»¶ï¼Œæˆ‘ä»¬æƒ³ç›‘å¬æ»šåŠ¨è¡Œä¸ºæ¥æ‰§è¡Œå‡½æ•°ï¼Œç”¨é˜²æŠ–å¯ä»¥è¿™æ ·æ¥åš</p>
<ul>
<li>ç®€æ˜“ç‰ˆ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">fn, wait</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> timeout<br>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span><br>    <span class="hljs-keyword">let</span> arg = <span class="hljs-built_in">arguments</span><br>    <span class="hljs-keyword">if</span>(timeout) clearTimeout(timeout)<br>    timeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>      fn.apply(context, arg)<br>    &#125;,wait)<br>  &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">print</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æˆ‘æ˜¯é˜²æŠ–'</span>)<br>&#125;<br><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'scroll'</span>, debounce(print, <span class="hljs-number">1000</span>))<br></code></pre></td></tr></table></figure>

<ul>
<li>ç«‹å³æ‰§è¡Œç‰ˆ</li>
</ul>
<p>å¦‚æœå¸Œæœ›è§¦å‘ä¹‹åç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œç„¶åç­‰å¾…nç§’åæ‰å¯ä»¥é‡æ–°è§¦å‘æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨nç§’å†…å†æ¬¡è§¦å‘ä¼šé‡æ–°è®¡æ—¶nç§’</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">fn, wait, immediate</span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> timer<br>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">this</span><br>    <span class="hljs-keyword">const</span> arg = <span class="hljs-built_in">arguments</span><br>    <span class="hljs-keyword">if</span>(timer) clearTimeout(timer)<br>    <span class="hljs-keyword">if</span>(immediate)&#123;<br>      <span class="hljs-keyword">const</span> callNow = !timer<br>      timer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>        timer = <span class="hljs-literal">null</span><br>      &#125;, wait)<br>      <span class="hljs-keyword">if</span>(callNow) fn.apply(context, arg)<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>      timer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>        fn.apply(context, arg)<br>      &#125;, wait)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;è¿™æ ·å¦‚æœåœ¨1så†…æˆ‘ä»¬å¤šæ¬¡è§¦å‘è¿™ä¸ªè¡Œä¸ºï¼Œé‚£ä¹ˆè®¡æ—¶å™¨ä¼šä¸åœçš„é‡æ–°è®¡ç®—ï¼Œç›´åˆ°åœ¨1så†…æˆ‘ä»¬æ²¡æœ‰å†æ¬¡è§¦å‘è¯¥è¡Œä¸ºï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ª print äº‹ä»¶</p>
<ul>
<li>åº”ç”¨åœºæ™¯ï¼š<ul>
<li>æŒ‰é’®æäº¤ï¼šé˜²æ­¢å¤šæ¬¡æäº¤ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡å¾—æäº¤</li>
<li>æœç´¢æ¡†è”æƒ³ï¼šé˜²æ­¢è”æƒ³å‘é€è¯·æ±‚ï¼Œåªå‘é€æœ€åä¸€æ¬¡</li>
</ul>
</li>
</ul>
<h3 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å‡½æ•°çš„èŠ‚æµå°±æ˜¯åœ¨é«˜é¢‘çš„è§¦å‘æŸä¸ªè¡Œä¸ºæ—¶ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªè§„å®šçš„æ—¶é—´ï¼Œåœ¨è¯¥æ—¶é—´å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼ŒèŠ‚æµä¼šç¨€é‡Šå‡½æ•°æ‰§è¡Œçš„é¢‘ç‡ã€‚</p>
<blockquote>
<p>ç®€è¿°ï¼šå•ä½æ—¶é—´å†…å¤šæ¬¡è§¦å‘åªä¼šæ‰§è¡Œä¸€æ¬¡</p>
</blockquote>
<p>æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸Šè¿°çš„æ»šåŠ¨äº‹ä»¶æ¥ä¸¾ä¾‹ï¼Œä»£ç å¦‚ä¸‹</p>
<ul>
<li>æ–¹æ¡ˆä¸€</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">fn, wait</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>, timer = <span class="hljs-literal">null</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> now = <span class="hljs-built_in">Date</span>.now()<br>    <span class="hljs-keyword">let</span> arg = <span class="hljs-built_in">arguments</span><br>    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span><br>    <span class="hljs-keyword">if</span> (now - time &gt; wait) &#123;<br>      fn.apply(context, arg)<br>      time = now<br>    &#125; <span class="hljs-keyword">else</span> (<br>      timer &amp;&amp; clearTimeout(timer)<br>      timer = setTimeout( <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        time = now<br>        fn.apply(context, arg)<br>      &#125;, wait)<br>    )<br>  &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">print</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æˆ‘æ˜¯èŠ‚æµ'</span>)<br>&#125;<br><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'scroll'</span>, throttle(print, <span class="hljs-number">1000</span>))<br></code></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ¡ˆäºŒ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">fn, wait</span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> previous = <span class="hljs-number">0</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">let</span> now  = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span><br>    <span class="hljs-keyword">let</span> arg = <span class="hljs-built_in">arguments</span><br>    <span class="hljs-keyword">if</span>(now - previous &gt; wait)&#123;<br>      fn.apply(context, arg)<br>      previous = now<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ¡ˆä¸‰</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">fn, wait</span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> timer<br>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span><br>    <span class="hljs-keyword">let</span> arg = <span class="hljs-built_in">arguments</span><br>    <span class="hljs-keyword">if</span>(!timer)&#123;<br>      timer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>        timer = <span class="hljs-literal">null</span><br>        fn.apply(context, arg)<br>      &#125;, wait)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>åº”ç”¨åœºæ™¯ï¼š<ul>
<li>æ‹–æ‹½ï¼šå›ºå®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ï¼Œé˜²æ­¢è¶…é«˜é¢‘æ¬¡è§¦å‘ä½ç½®å˜åŠ¨</li>
<li>ç¼©æ”¾ï¼šç›‘æ§æµè§ˆå™¨resize</li>
</ul>
</li>
</ul>
<h3 id="èŠ‚æµå’Œé˜²æŠ–ä¹‹é—´çš„åŒºåˆ«"><a href="#èŠ‚æµå’Œé˜²æŠ–ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="èŠ‚æµå’Œé˜²æŠ–ä¹‹é—´çš„åŒºåˆ«"></a>èŠ‚æµå’Œé˜²æŠ–ä¹‹é—´çš„åŒºåˆ«</h3><ul>
<li>èŠ‚æµæ˜¯ä¸ç®¡è§¦å‘äº‹ä»¶å¤šé¢‘ç¹ï¼Œéƒ½ä¼šåœ¨ä¸€å®šçš„æ—¶é—´å†…æ‰§è¡Œä¸€æ¬¡ï¼Œè€Œé˜²æŠ–ä¼šåœ¨é¢‘ç¹è§¦å‘çš„æœ€åä¸€æ¬¡æ‰æ‰§è¡Œ</li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-webpack04" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/06/07/webpack04/"
    >webpack04</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/06/07/webpack04/" class="article-date">
  <time datetime="2020-06-07T17:43:01.000Z" itemprop="datePublished">2020-06-08</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/%E5%89%8D%E7%AB%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">å‰ç«¯æ„å»ºå·¥å…·</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="webpackå¼€å‘ç¯å¢ƒçš„æ€§èƒ½ä¼˜åŒ–"><a href="#webpackå¼€å‘ç¯å¢ƒçš„æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="webpackå¼€å‘ç¯å¢ƒçš„æ€§èƒ½ä¼˜åŒ–"></a>webpackå¼€å‘ç¯å¢ƒçš„æ€§èƒ½ä¼˜åŒ–</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å¼€å‘ç¯å¢ƒä¸‹çš„ä¼˜åŒ–å¯ä»¥åˆ†ä¸ºä¸¤æ–¹é¢ï¼šä¼˜åŒ–å¼€å‘ç¯å¢ƒä¸‹æ‰“åŒ…æ„å»ºé€Ÿåº¦ã€ä¼˜åŒ–ä»£ç è°ƒè¯•ã€‚</p>
<ul>
<li><p>ä¼˜åŒ–æ‰“åŒ…æ„å»ºé€Ÿåº¦ï¼ˆHMRï¼‰</p>
<p>  HMR å³ hot module replacement çƒ­æ¨¡å—æ›¿æ¢ / æ¨¡å—çƒ­æ›¿æ¢ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼Œä¸€ä¸ªæ¨¡å—å‘ç”Ÿå˜åŒ–ï¼Œåªä¼šé‡æ–°æ‰“åŒ…è¿™ä¸€ä¸ªæ¨¡å—ï¼Œè€Œä¸æ˜¯æ‰“åŒ…æ‰€æœ‰æ¨¡å—ï¼Œå¯ä»¥æå¤§çš„æå‡æ„å»ºé€Ÿåº¦ã€‚åªéœ€è¦åœ¨ devServer ä¸­é…ç½® <code>hot: true</code>å³å¯ã€‚</p>
<p>  å¯¹äºcss æ¥è¯´ï¼Œstyle-loader å·²ç»å†…éƒ¨å®ç°äº†è¿™ä¸€ä¸ªåŠŸèƒ½ï¼›è€Œ js æ˜¯é»˜è®¤ä¸èƒ½ä½¿ç”¨ HMR è¿™ä¸ªåŠŸèƒ½çš„ï¼Œéœ€è¦ä¿®æ”¹ js ä»£ç ï¼Œæ·»åŠ æ”¯æŒHMRåŠŸèƒ½çš„ä»£ç ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼ŒHMR å¯¹äº js æ¥è¯´åªèƒ½å¤„ç†éå…¥å£ js æ–‡ä»¶çš„å…¶ä»–æ–‡ä»¶ï¼›html ä¹Ÿæ˜¯é»˜è®¤ä¸èƒ½ä½¿ç”¨ HMR è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯ html ä¹Ÿä¸éœ€è¦åšè¿™ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ª index.htmlæ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€æ—¦æ›´æ–°äº†ï¼ŒåŠ¿å¿…è¦æ‰€æœ‰çš„æ¨¡å—éƒ½è¦é‡æ–°æ‰“åŒ…ï¼Œä½†æ˜¯ HMR ä¼šå¯¼è‡´å¦ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ html ä¸èƒ½çƒ­æ›´æ–°äº†ï¼Œæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜å°±è¦ä¿®æ”¹æˆ‘ä»¬çš„å…¥å£ï¼Œå°†htmlæ–‡ä»¶å¼•å…¥ã€‚</p>
<p>  webpacké…ç½®</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment">HMRï¼šhot module replacement çƒ­æ¨¡å—æ›¿æ¢ / æ¨¡å—çƒ­æ›¿æ¢</span><br><span class="hljs-comment">    ä½œç”¨ï¼šä¸€ä¸ªæ¨¡å—å‘ç”Ÿå˜åŒ–ï¼Œåªä¼šé‡æ–°æ‰“åŒ…è¿™ä¸€ä¸ªæ¨¡å—ï¼ˆè€Œä¸æ˜¯æ‰“åŒ…æ‰€æœ‰æ¨¡å—ï¼‰</span><br><span class="hljs-comment">    æå¤§æå‡æ„å»ºé€Ÿåº¦</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    æ ·å¼æ–‡ä»¶ï¼šå¯ä»¥ä½¿ç”¨HMRåŠŸèƒ½ï¼Œå› ä¸ºstyle-loaderå†…éƒ¨å®ç°äº†</span><br><span class="hljs-comment">    jsæ–‡ä»¶ï¼šé»˜è®¤ä¸èƒ½ä½¿ç”¨HMRåŠŸèƒ½ --&gt; éœ€è¦ä¿®æ”¹jsä»£ç ï¼Œæ·»åŠ æ”¯æŒHMRåŠŸèƒ½çš„ä»£ç </span><br><span class="hljs-comment">    æ³¨æ„ï¼šHMRåŠŸèƒ½å¯¹äºjsæ¥è¯´åªèƒ½å¤„ç†éå…¥å£jsæ–‡ä»¶çš„å…¶ä»–æ–‡ä»¶</span><br><span class="hljs-comment">    htmlæ–‡ä»¶ï¼šé»˜è®¤ä¸èƒ½ä½¿ç”¨HMRåŠŸèƒ½ã€‚åŒæ—¶ä¼šå¯¼è‡´é—®é¢˜ï¼šhtmlæ–‡ä»¶ä¸èƒ½çƒ­æ›´æ–°äº†(ä¸éœ€è¦åšHMRåŠŸèƒ½)</span><br><span class="hljs-comment">    è§£å†³ï¼šä¿®æ”¹entryå…¥å£ï¼Œå°†Htmlæ–‡ä»¶å¼•å…¥</span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: [<span class="hljs-string">'./src/js/index.js'</span>, <span class="hljs-string">'./src/index.html'</span>],<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname,<span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.css$/</span>,<br>                use: [<span class="hljs-string">'style-loader'</span>,<span class="hljs-string">'css-loader'</span>]<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.less$/</span>,<br>                use: [<span class="hljs-string">'style-loader'</span>,<span class="hljs-string">'css-loader'</span>,<span class="hljs-string">'less-loader'</span>]<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.(jpg|png|gif)$/</span>,<br>                loader: <span class="hljs-string">'url-loader'</span>,<br>                options: &#123;<br>                    limit: <span class="hljs-number">8</span> * <span class="hljs-number">1024</span>,<br>                    esModule: <span class="hljs-literal">false</span>,<br>                    name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                    outputPath: <span class="hljs-string">'imgs'</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                exclude: <span class="hljs-regexp">/\.(html|js|css|less|jpg|png|gif)/</span>,<br>                loader: <span class="hljs-string">'file-loader'</span>,<br>                options: &#123;<br>                    name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                    outputPath: <span class="hljs-string">'media'</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.html$/</span>,<br>                loader: <span class="hljs-string">'html-loader'</span><br>            &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">"./src/index.html"</span><br>        &#125;)<br>    ],<br>    mode: <span class="hljs-string">'development'</span>,<br>    devServer: &#123;<br>        contentBase: resolve(__dirname,<span class="hljs-string">'build'</span>),<br>        compress: <span class="hljs-literal">true</span>,<br>        port: <span class="hljs-number">3000</span>,<br>        open: <span class="hljs-literal">true</span>,<br>        <span class="hljs-comment">// å¼€å¯HMRåŠŸèƒ½</span><br>        <span class="hljs-comment">// å½“ä¿®æ”¹äº†webpacké…ç½®ï¼Œæ–°é…ç½®è¦æƒ³ç”Ÿæ•ˆï¼Œå¿…é¡»é‡å¯webpackæœåŠ¡</span><br>        hot: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>  index.jsä¸­çš„ä»£ç </p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-string">'../css/iconfont.css'</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">'../css/index.less'</span><br><span class="hljs-keyword">import</span> print <span class="hljs-keyword">from</span> <span class="hljs-string">'./print'</span><br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'jsè¢«é‡æ–°åŠ è½½äº†'</span>)<br><br>print()<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x,y</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> x+y<br>&#125;<br><span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">module</span>.hot)&#123;<br>    <span class="hljs-comment">// ä¸€æ—¦module.hotä¸ºtrue,è¯´æ˜å¼€å¯äº†HMRåŠŸèƒ½ --&gt; è®©HMRå·¥èƒ½ç”Ÿæ•ˆ</span><br>    <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./print.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-comment">// æ–¹æ³•ä¼šç›‘å¬print.jsæ–‡ä»¶çš„å˜åŒ–ï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œå…¶ä»–æ¨¡å—ä¸ä¼šé‡æ–°æ‰“åŒ…æ„å»ºï¼Œ</span><br>        <span class="hljs-comment">// ä¼šæ‰§è¡Œåé¢çš„å›è°ƒå‡½æ•°</span><br>        print()<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>source-map</p>
<p>  source-map ä¸€ç§æä¾›æºä»£ç åˆ°æ„å»ºåä»£ç æ˜ å°„æŠ€æœ¯ï¼ˆå¦‚æœæ„å»ºåä»£ç å‡ºé”™äº†ï¼Œé€šè¿‡æ˜ å°„å¯ä»¥è¿½è¸ªæºä»£ç é”™è¯¯ï¼‰ï¼Œå®ƒçš„ç»„åˆæ–¹å¼ä¸º<code>[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</code>ï¼Œåœ¨ devtool ä¸­è®¾ç½®å³å¯</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: [<span class="hljs-string">'./src/js/index.js'</span>, <span class="hljs-string">'./src/index.html'</span>],<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname,<span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.css$/</span>,<br>                use: [<span class="hljs-string">'style-loader'</span>,<span class="hljs-string">'css-loader'</span>]<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.less$/</span>,<br>                use: [<span class="hljs-string">'style-loader'</span>,<span class="hljs-string">'css-loader'</span>,<span class="hljs-string">'less-loader'</span>]<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.(jpg|png|gif)$/</span>,<br>                loader: <span class="hljs-string">'url-loader'</span>,<br>                options: &#123;<br>                limit: <span class="hljs-number">8</span> * <span class="hljs-number">1024</span>,<br>                esModule: <span class="hljs-literal">false</span>,<br>                name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                outputPath: <span class="hljs-string">'imgs'</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                exclude: <span class="hljs-regexp">/\.(html|js|css|less|jpg|png|gif)/</span>,<br>                loader: <span class="hljs-string">'file-loader'</span>,<br>                options: &#123;<br>                name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                outputPath: <span class="hljs-string">'media'</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.html$/</span>,<br>                loader: <span class="hljs-string">'html-loader'</span><br>            &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">"./src/index.html"</span><br>        &#125;)<br>    ],<br>    mode: <span class="hljs-string">'development'</span>,<br>    devServer: &#123;<br>        contentBase: resolve(__dirname,<span class="hljs-string">'build'</span>),<br>        compress: <span class="hljs-literal">true</span>,<br>        port: <span class="hljs-number">3000</span>,<br>        open: <span class="hljs-literal">true</span>,<br>        hot: <span class="hljs-literal">true</span><br>    &#125;,<br>    devtool: <span class="hljs-string">'inline-source-map'</span><br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">source-map: ä¸€ç§æä¾›æºä»£ç åˆ°æ„å»ºåä»£ç æ˜ å°„æŠ€æœ¯(å¦‚æœæ„å»ºåä»£ç å‡ºé”™äº†ï¼Œé€šè¿‡æ˜ å°„å¯ä»¥è¿½è¸ªæºä»£ç é”™è¯¯)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">source-mapï¼šå¤–éƒ¨</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ å’Œ æºä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">inline-source-mapï¼šå†…è”</span><br><span class="hljs-comment">    åªç”Ÿæˆä¸€ä¸ªå†…è”source-map</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ å’Œ æºä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">hidden-source-mapï¼šå¤–éƒ¨</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç é”™è¯¯åŸå› ï¼Œä½†æ˜¯æ²¡æœ‰é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">    ä¸èƒ½è¿½è¸ªæºä»£ç é”™è¯¯ï¼Œåªèƒ½æç¤ºåˆ°æ„å»ºåä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">eval-source-mapï¼šå†…è”</span><br><span class="hljs-comment">    æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½ç”Ÿæˆå¯¹åº”çš„source-mapï¼Œéƒ½åœ¨eval</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ å’Œ æºä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">nosources-source-mapï¼šå¤–éƒ¨</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•æºä»£ç ä¿¡æ¯</span><br><span class="hljs-comment">cheap-source-mapï¼šå¤–éƒ¨</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ å’Œ æºä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">    åªèƒ½ç²¾ç¡®åˆ°è¡Œ</span><br><span class="hljs-comment">cheap-module-source-mapï¼šå¤–éƒ¨</span><br><span class="hljs-comment">    é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ å’Œ æºä»£ç çš„é”™è¯¯ä½ç½®</span><br><span class="hljs-comment">    moduleä¼šå°†loaderçš„source mapåŠ å…¥</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">å†…è”å’Œå¤–éƒ¨çš„åŒºåˆ«ï¼š1.å¤–éƒ¨ç”Ÿæˆäº†æ–‡ä»¶ï¼Œå†…è”æ²¡æœ‰ã€‚2.å†…è”æ„å»ºé€Ÿåº¦æ›´å¿«</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">å¼€å‘ç¯å¢ƒï¼šé€Ÿåº¦å¿«ï¼Œè°ƒè¯•æ›´å‹å¥½</span><br><span class="hljs-comment">    é€Ÿåº¦å¿«ï¼ˆeval&gt;inline&gt;cheap&gt;...ï¼‰</span><br><span class="hljs-comment">    eval-cheap-source-map</span><br><span class="hljs-comment">    eval-source-map</span><br><span class="hljs-comment">    è°ƒè¯•æ›´å‹å¥½</span><br><span class="hljs-comment">    source-map</span><br><span class="hljs-comment">    cheap-module-source-map</span><br><span class="hljs-comment">    cheap-source-map</span><br><span class="hljs-comment">    --&gt; eval-source-map / eval-cheap-module-source-map</span><br><span class="hljs-comment">ç”Ÿäº§ç¯å¢ƒï¼šæºä»£ç è¦ä¸è¦éšè—ï¼Œè°ƒè¯•è¦ä¸è¦æ›´å‹å¥½</span><br><span class="hljs-comment">    å†…è”ä¼šè®©ä»£ç ä½“ç§¯å˜å¤§ï¼Œæ‰€ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¸ç”¨å†…è”</span><br><span class="hljs-comment">    nosources-source-map å…¨éƒ¨éšè—</span><br><span class="hljs-comment">    hidden-source-map åªéšè—æºä»£ç ï¼Œä¼šæç¤ºæ„å»ºåä»£ç é”™è¯¯ä¿¡æ¯</span><br><span class="hljs-comment">    --&gt; source-map / cheap-module-source-map</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>oneOf æå‡æ„å»ºé€Ÿåº¦</p>
<p>  æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ–‡ä»¶åŒ¹é… loaderï¼Œä¼šæŠŠæ‰€æœ‰çš„ loader é…ç½®éƒ½èµ°ä¸€éï¼Œè¿™æ ·ä¼šå¤§å¤§é™ä½æˆ‘ä»¬çš„æ„å»ºé€Ÿåº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ—¶å€™å¯ä»¥é€‰ oneOfï¼Œä¸€æ—¦åŒ¹é…åˆ°å°±ä¸ä¼šç»§ç»­å‘ä¸‹åŒ¹é…ï¼Œä½†æ˜¯æœ‰çš„æ–‡ä»¶éœ€è¦åŒ¹é…å¤šä¸ª loaderï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå…¶å®ƒçš„ loader æå–å‡ºæ¥å°±å¯ä»¥äº†</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123;resolve&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mini-css-extract-plugin'</span>)<br><span class="hljs-keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'optimize-css-assets-webpack-plugin'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br>process.env.NODE_ENV = <span class="hljs-string">'production'</span><br><br><span class="hljs-comment">// å¤ç”¨loader</span><br><span class="hljs-keyword">const</span> commonCssLoader =  [<br>    MiniCssExtractPlugin.loader,<br>    <span class="hljs-string">'css-loader'</span>,<br>    &#123;<br>        loader: <span class="hljs-string">'postcss-loader'</span>,<br>        options: &#123;<br>            ident: <span class="hljs-string">'postcss'</span>,<br>            plugins: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> [<br>                <span class="hljs-built_in">require</span>(<span class="hljs-string">'postcss-preset-env'</span>)()<br>            ]<br>        &#125;<br>    &#125;<br>]<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">'./src/js/index.js'</span>,<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname,<span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                exclude: <span class="hljs-regexp">/node_module/</span>,<br>                enforce: <span class="hljs-string">'pre'</span>,<br>                loader: <span class="hljs-string">'eslint-loader'</span>,<br>                options: &#123;<br>                    fix: <span class="hljs-literal">true</span><br>                &#125;<br>            &#125;,<br>            &#123;<br>                <span class="hljs-comment">// ä»¥ä¸‹loaderåªä¼šåŒ¹é…ä¸€ä¸ª</span><br>                <span class="hljs-comment">// æ³¨æ„ï¼šä¸èƒ½æœ‰ä¸¤ä¸ªé…ç½®å¤„ç†åŒä¸€ç±»å‹æ–‡ä»¶</span><br>                <span class="hljs-comment">// æå‡æ„å»ºé€Ÿåº¦ï¼Œè®©æˆ‘ä»¬è¿™ä¸ªæ–‡ä»¶ä»¥åä¸ä¼šåå¤çš„è¢«å¤šä¸ªloaderéƒ½å»è¿‡ä¸€é</span><br>                oneOf: [<br>                    &#123;<br>                        test: <span class="hljs-regexp">/\.css$/</span>,<br>                        use: [...commonCssLoader]<br>                    &#125;,<br>                    &#123;<br>                        test: <span class="hljs-regexp">/\.less$/</span>,<br>                        use: [<br>                            ...commonCssLoader,<br>                            <span class="hljs-string">'less-loader'</span><br>                        ]<br>                    &#125;,<br>                    &#123;<br>                        test: <span class="hljs-regexp">/\.js$/</span>,<br>                        exclude: <span class="hljs-regexp">/node_module/</span>,<br>                        loader: <span class="hljs-string">'babel-loader'</span>,<br>                        options: &#123;<br>                            presets: [<br>                                <span class="hljs-string">'@babel/preset-env'</span>,<br>                                &#123;<br>                                    useBuiltIns: <span class="hljs-string">'usage'</span>,<br>                                    corejs: &#123;<span class="hljs-attr">version</span>: <span class="hljs-number">3</span>&#125;,<br>                                    targets: &#123;<br>                                        chrome: <span class="hljs-string">'60'</span>,<br>                                        firefox: <span class="hljs-string">'50'</span><br>                                    &#125;<br>                                &#125;<br>                            ]<br>                        &#125;<br>                    &#125;,<br>                    &#123;<br>                        test: <span class="hljs-regexp">/\.(gif|jpg|png)/</span>,<br>                        loader: <span class="hljs-string">'url-loader'</span>,<br>                        options: &#123;<br>                            limit: <span class="hljs-number">8</span> * <span class="hljs-number">1024</span>,<br>                            name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                            outputPath: <span class="hljs-string">'imgs'</span>,<br>                            esModule: <span class="hljs-literal">false</span><br>                        &#125;<br>                    &#125;,<br>                    &#123;<br>                        test: <span class="hljs-regexp">/\.html$/</span>,<br>                        loader: <span class="hljs-string">'html-loader'</span><br>                    &#125;,<br>                    &#123;<br>                        exclude: <span class="hljs-regexp">/\.(js|css|html|less|jpg|png|gif)/</span>,<br>                        loader: <span class="hljs-string">'file-loader'</span>,<br>                        options: &#123;<br>                            outputPath: <span class="hljs-string">'media'</span><br>                        &#125;<br>                    &#125;<br>                ]<br>            &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;<br>            filename: <span class="hljs-string">'css/built.css'</span><br>        &#125;),<br>        <span class="hljs-keyword">new</span> OptimizeCssAssetsWebpackPlugin(),<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">'./src/index.html'</span>,<br>            minify: &#123;<br>                collapseWhitespace: <span class="hljs-literal">true</span>,<br>                removeComments: <span class="hljs-literal">true</span><br>            &#125;<br>        &#125;)<br><br>    ],<br>    mode: <span class="hljs-string">'production'</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/webpack/" rel="tag">webpack</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-webpack03" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/05/31/webpack03/"
    >webpack03</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/05/31/webpack03/" class="article-date">
  <time datetime="2020-05-31T11:03:18.000Z" itemprop="datePublished">2020-05-31</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/%E5%89%8D%E7%AB%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">å‰ç«¯æ„å»ºå·¥å…·</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="eslintæ£€æŸ¥js"><a href="#eslintæ£€æŸ¥js" class="headerlink" title="eslintæ£€æŸ¥js"></a>eslintæ£€æŸ¥js</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å¦‚æœæˆ‘ä»¬å¥½å¤šäººå¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªäººæœ‰è‡ªå·±ä¸€å¥—ä»£ç è§„èŒƒï¼Œè¿™æ ·ä¼šé€ æˆä»£ç æ··ä¹±ï¼Œä¸å®œç»´æŠ¤ã€‚è€Œ eslint å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©å¼€å‘è€…ä½¿ç”¨åŒä¸€å¥—ä»£ç è§„èŒƒã€‚</p>
<p>webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">'./src/js/index.js'</span>,<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname, <span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                è¯­æ³•æ£€æŸ¥ï¼šeslint-loader eslint</span><br><span class="hljs-comment">                æ³¨æ„ï¼šåªæ£€æŸ¥è‡ªå·±å†™çš„æºä»£ç ï¼Œç¬¬ä¸‰æ–¹çš„åº“æ˜¯ä¸ç”¨æ£€æŸ¥çš„ã€‚</span><br><span class="hljs-comment">                è®¾ç½®æ£€æŸ¥è§„åˆ™ï¼š</span><br><span class="hljs-comment">                    package.jsonä¸­eslintConfigä¸­è®¾ç½®</span><br><span class="hljs-comment">                        "eslintConfig":&#123;</span><br><span class="hljs-comment">                            "extends": "airbnb-base"</span><br><span class="hljs-comment">                        &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                    https://github.com/airbnb/javascript</span><br><span class="hljs-comment">                    airbnb   --&gt;  eslint-config-airbnb-base eslint eslint-plugin-import</span><br><span class="hljs-comment">            */</span><br>           &#123;<br>               test: <span class="hljs-regexp">/\.js$/</span>,<br>               exclude: <span class="hljs-regexp">/node_modules/</span>,<br>               loader: <span class="hljs-string">'eslint-loader'</span>,<br>               options: &#123;<br>                   <span class="hljs-comment">// è‡ªåŠ¨ä¿®å¤eslintçš„é”™è¯¯</span><br>                   fix: <span class="hljs-literal">true</span><br>               &#125;<br>           &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">'./src/index.html'</span><br>        &#125;)<br>    ],<br>    mode: <span class="hljs-string">'development'</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>éœ€è¦ <code>npm i eslint-loader eslint eslint-config-airbnb-base eslint-plugin-import</code></p>
<p>package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"webpack_code"</span>,<br>  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,<br>  <span class="hljs-attr">"description"</span>: <span class="hljs-string">""</span>,<br>  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,<br>  <span class="hljs-attr">"scripts"</span>: &#123;<br>    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span><br>  &#125;,<br>  <span class="hljs-attr">"author"</span>: <span class="hljs-string">""</span>,<br>  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span>,<br>  <span class="hljs-attr">"devDependencies"</span>: &#123;<br>    <span class="hljs-attr">"css-loader"</span>: <span class="hljs-string">"^3.5.3"</span>,<br>    <span class="hljs-attr">"eslint"</span>: <span class="hljs-string">"^7.1.0"</span>,<br>    <span class="hljs-attr">"eslint-config-airbnb-base"</span>: <span class="hljs-string">"^14.1.0"</span>,<br>    <span class="hljs-attr">"eslint-loader"</span>: <span class="hljs-string">"^4.0.2"</span>,<br>    <span class="hljs-attr">"eslint-plugin-import"</span>: <span class="hljs-string">"^2.20.2"</span>,<br>    <span class="hljs-attr">"file-loader"</span>: <span class="hljs-string">"^6.0.0"</span>,<br>    <span class="hljs-attr">"html-loader"</span>: <span class="hljs-string">"^1.1.0"</span>,<br>    <span class="hljs-attr">"html-webpack-plugin"</span>: <span class="hljs-string">"^4.3.0"</span>,<br>    <span class="hljs-attr">"less"</span>: <span class="hljs-string">"^3.11.1"</span>,<br>    <span class="hljs-attr">"less-loader"</span>: <span class="hljs-string">"^6.1.0"</span>,<br>    <span class="hljs-attr">"mini-css-extract-plugin"</span>: <span class="hljs-string">"^0.9.0"</span>,<br>    <span class="hljs-attr">"optimize-css-assets-webpack-plugin"</span>: <span class="hljs-string">"^5.0.3"</span>,<br>    <span class="hljs-attr">"postcss-loader"</span>: <span class="hljs-string">"^3.0.0"</span>,<br>    <span class="hljs-attr">"postcss-preset-env"</span>: <span class="hljs-string">"^6.7.0"</span>,<br>    <span class="hljs-attr">"style-loader"</span>: <span class="hljs-string">"^1.2.1"</span>,<br>    <span class="hljs-attr">"url-loader"</span>: <span class="hljs-string">"^4.1.0"</span>,<br>    <span class="hljs-attr">"webpack"</span>: <span class="hljs-string">"^4.43.0"</span>,<br>    <span class="hljs-attr">"webpack-cli"</span>: <span class="hljs-string">"^3.3.11"</span>,<br>    <span class="hljs-attr">"webpack-dev-server"</span>: <span class="hljs-string">"^3.11.0"</span><br>  &#125;,<br>  <span class="hljs-attr">"browserslist"</span>: &#123;<br>    <span class="hljs-attr">"development"</span>: [<br>      <span class="hljs-string">"last 1 chrome version"</span>,<br>      <span class="hljs-string">"last 1 firefox version"</span>,<br>      <span class="hljs-string">"last 1 safari version"</span><br>    ],<br>    <span class="hljs-attr">"production"</span>: [<br>      <span class="hljs-string">"&gt;0.2%"</span>,<br>      <span class="hljs-string">"not dead"</span>,<br>      <span class="hljs-string">"not op_mini all"</span><br>    ]<br>  &#125;,<br>  <span class="hljs-attr">"eslintConfig"</span>:&#123;<br>    <span class="hljs-attr">"extends"</span>: <span class="hljs-string">"airbnb-base"</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥è¯•éªŒä¸€ä¸‹ï¼Œåœ¨ js ä¸­å†™ä¸€äº›ä¸è§„èŒƒçš„ä»£ç </p>
<p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> a+b;<br>&#125;<br><span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>))<br></code></pre></td></tr></table></figure>
<p>ä¹‹åè¿è¡Œwebpackï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ index.js æ–‡ä»¶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));<br></code></pre></td></tr></table></figure>
<p>æ‰€æœ‰çš„ä»£ç éƒ½è§„èŒƒäº†ï¼Œä½†æ˜¯ï¼Œåœ¨æ§åˆ¶å°æœ‰ä¸€ä¸ªè­¦å‘Šï¼Œå»ºè®®æˆ‘ä»¬ä¸è¦åœ¨è¿™é‡Œå†™ console.log</p>
<img src="/blog/2020/05/31/webpack03/warn.png" class="">

<p>æˆ‘ä»¬å†æ¥ä¿®æ”¹ä¸€ä¸‹è¿™ä¸ª index.js æ–‡ä»¶å§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-comment">// ä¸‹ä¸€è¡Œeslintæ‰€æœ‰è§„åˆ™éƒ½å¤±æ•ˆï¼ˆä¸‹ä¸€è¡Œä¸è¿›è¡Œeslintæ£€æŸ¥ï¼‰</span><br><span class="hljs-comment">// eslint-disable-next-line</span><br><span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));<br></code></pre></td></tr></table></figure>

<p>ç°åœ¨å†è¿è¡Œ webpack å°±ä¸ä¼šæœ‰ä»»ä½•è­¦å‘Šäº†</p>
<h3 id="babelå¤„ç†jså…¼å®¹æ€§"><a href="#babelå¤„ç†jså…¼å®¹æ€§" class="headerlink" title="babelå¤„ç†jså…¼å®¹æ€§"></a>babelå¤„ç†jså…¼å®¹æ€§</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;å½“æˆ‘ä»¬ä½¿ç”¨ ES6 è¯­æ³•æ¥å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬åœ¨è°·æ­Œæµè§ˆå™¨æ‰“å¼€å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨IEæ‰“å¼€å°±ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚ç®­å¤´å‡½æ•°ï¼Œåœ¨IEä¸‹æ˜¯ä¸è¯†åˆ«çš„ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° babel äº†ï¼Œæ¥å°† ES6 ç”šè‡³æ›´é«˜çº§çš„è¯­æ³•è½¬æ¢æˆæµè§ˆå™¨è¯†åˆ«çš„è¯­æ³•ã€‚æˆ‘ä»¬éœ€è¦ä¸‹è½½ <code>babel-loader</code> <code>@babel/core</code> <code>@babel/preset-env</code></p>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;åœ¨ webpack ä¸­ï¼ŒæŒ‰ç…§ä»¥ä¸Šçš„æ–¹æ³•å¤„ç†åï¼Œç¡®å® IE èƒ½è¯†åˆ«åƒç®­å¤´å‡½æ•°è¿™æ ·çš„è¯­æ³•äº†ï¼Œä½†æ˜¯åƒæ›´é«˜çº§çš„è¯­æ³• promise å´è¿˜æ˜¯æ— æ³•è¯†åˆ«ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦åšå…¨éƒ¨å…¼å®¹æ€§å¤„ç†ï¼Œç”¨åˆ° <code>@babel/polyfill</code> ï¼Œä¸‹è½½å®Œæˆåï¼Œåªéœ€åœ¨ä»£ç ä¸­ç”¨ <code>import &#39;@babel/polyfill&#39;</code>å¼•å…¥å³å¯ï¼Œæˆ‘ä»¬å†æ‰“å¼€æµè§ˆå™¨çœ‹ä¸€ä¸‹ï¼Œç¡®å®å¯ä»¥è¯†åˆ«äº† promiseã€‚</p>
<p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;è™½ç„¶ç°åœ¨æ‰€æœ‰çš„è¯­æ³•éƒ½è¯†åˆ«äº†ï¼Œä½†ç°åœ¨è¿˜æ˜¯æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œä¹‹å‰æˆ‘ä»¬æ‰“çš„åŒ…å¯èƒ½ä¹Ÿå°±å‡ åKBï¼Œå¯æ˜¯ç°åœ¨æ‰“å‡ºæ¥çš„åŒ…éœ€è¦å‡ ç™¾KBï¼Œä¸€ä¸‹å­æ‰“äº†å¥½å¤šï¼Œåˆ«ç€æ€¥ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç”¨æŒ‰éœ€åŠ è½½äº†ï¼Œåªéœ€è¦åŠ è½½æˆ‘ä»¬éœ€è¦åšå…¼å®¹æ€§å¤„ç†çš„éƒ¨åˆ†å°±å¥½äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½ä¸€ä¸ª <code>core-js</code>ï¼Œwebpackå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">'./src/js/index.js'</span>,<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname, <span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>           <span class="hljs-comment">/*</span><br><span class="hljs-comment">            jså…¼å®¹æ€§å¤„ç†ï¼šbabel-loader @babel/core (éœ€ä¸‹è½½è¿™ä¸¤ä¸ª)</span><br><span class="hljs-comment">            1.åŸºæœ¬å…¼å®¹æ€§å¤„ç† --&gt; @babel/preset-env ï¼ˆä¸‹è½½ï¼‰</span><br><span class="hljs-comment">              é—®é¢˜ï¼šåªèƒ½è½¬æ¢åŸºæœ¬è¯­æ³•ï¼Œå¦‚promiseé«˜çº§è¯­æ³•ä¸èƒ½è½¬æ¢</span><br><span class="hljs-comment">            2.å…¨éƒ¨å…¼å®¹æ€§å¤„ç† --&gt; @babel/polyfill ï¼ˆä¸‹è½½ï¼‰</span><br><span class="hljs-comment">              é—®é¢˜ï¼šæˆ‘åªè¦è§£å†³éƒ¨åˆ†å…¼å®¹æ€§é—®é¢˜ï¼Œä½†æ˜¯å°†æ‰€æœ‰å…¼å®¹æ€§ä»£ç å…¨éƒ¨å¼•å…¥ï¼Œä½“ç§¯å¤ªå¤§äº†~</span><br><span class="hljs-comment">            3.éœ€è¦åšå…¼å®¹æ€§å¤„ç†çš„å°±åšï¼šæŒ‰éœ€åŠ è½½ --&gt; corejs (ä¸‹è½½core-js)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">           */</span><br>          &#123;<br>              test: <span class="hljs-regexp">/\.js$/</span>,<br>              exclude: <span class="hljs-regexp">/node_modules/</span>,<br>              loader: <span class="hljs-string">'babel-loader'</span>, <br>              options: &#123;<br>                  <span class="hljs-comment">// é¢„è®¾ï¼šæŒ‡ç¤ºbabelåšæ€ä¹ˆæ ·çš„å…¼å®¹æ€§å¤„ç†</span><br>                <span class="hljs-comment">// presets: ['@babel/preset-env']</span><br>                presets: [<br>                    <span class="hljs-string">'@babel/preset-env'</span>,<br>                    &#123;<br>                        <span class="hljs-comment">// æŒ‰éœ€åŠ è½½</span><br>                        useBuiltIns: <span class="hljs-string">'usage'</span>,<br>                        corejs: &#123;<br>                            version: <span class="hljs-number">3</span><br>                        &#125;,<br>                        <span class="hljs-comment">// æŒ‡å®šå…¼å®¹æ€§åšåˆ°å“ªä¸ªç‰ˆæœ¬çš„æµè§ˆå™¨</span><br>                        targets: &#123;<br>                            chrome: <span class="hljs-string">'60'</span>,<br>                            firefox: <span class="hljs-string">'60'</span>,<br>                            ie: <span class="hljs-string">'9'</span>,<br>                            safari: <span class="hljs-string">'10'</span>,<br>                            edge: <span class="hljs-string">'17'</span><br>                        &#125;<br>                    &#125;<br>                ]<br>              &#125;<br>          &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">'./src/index.html'</span><br>        &#125;)<br>    ],<br>    mode: <span class="hljs-string">'development'</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹æˆ‘ä»¬çš„åŒ…ï¼Œæ¯”ä¹‹å‰æ‰“å‡ºæ¥çš„åŒ…è¦å°å¾ˆå¤šï¼Œæ‰€ä»¥ï¼Œå¹³æ—¶æˆ‘ä»¬å¼€å‘æ—¶æ¨èä½¿ç”¨1ï¼Œ3æ–¹æ³•ï¼Œä¸æ¨èå…¨éƒ¨å…¼å®¹å¤„ç†ã€‚</p>
<h3 id="å‹ç¼©jsã€html"><a href="#å‹ç¼©jsã€html" class="headerlink" title="å‹ç¼©jsã€html"></a>å‹ç¼©jsã€html</h3><p>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;js çš„å‹ç¼©å¾ˆç®€å•ï¼Œåªéœ€è¦å°†<code>mode</code>è®¾ç½®ä¸º <code>production</code>å³å¯ï¼Œå› ä¸º webpack ä¼šé»˜è®¤å°†ç”Ÿäº§ç¯å¢ƒçš„ js ä»£ç è¿›è¡Œå‹ç¼©ï¼Œè€Œ html çš„å‹ç¼©éœ€è¦åœ¨ webpack ä¸­è¿›è¡Œç®€å•çš„é…ç½®ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">'./src/js/index.js'</span>,<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname, <span class="hljs-string">'build'</span>)<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">'./src/index.html'</span>,<br>            <span class="hljs-comment">// å‹ç¼©html</span><br>            minify: &#123;<br>                <span class="hljs-comment">// ç§»é™¤ç©ºæ ¼</span><br>                collapseWhitespace: <span class="hljs-literal">true</span>,<br>                <span class="hljs-comment">// ç§»é™¤æ³¨é‡Š</span><br>                removeComments: <span class="hljs-literal">true</span><br>            &#125;<br>        &#125;)<br>    ],<br>    <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒä¸‹ä¼šè‡ªåŠ¨å‹ç¼©jsä»£ç </span><br>    mode: <span class="hljs-string">'production'</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="å¼€å‘ç¯å¢ƒçš„é…ç½®"><a href="#å¼€å‘ç¯å¢ƒçš„é…ç½®" class="headerlink" title="å¼€å‘ç¯å¢ƒçš„é…ç½®"></a>å¼€å‘ç¯å¢ƒçš„é…ç½®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123;resolve&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mini-css-extract-plugin'</span>)<br><span class="hljs-keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'optimize-css-assets-webpack-plugin'</span>)<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)<br><br><span class="hljs-comment">// å®šä¹‰nodejsçš„ç¯å¢ƒå˜é‡ï¼šç»å†³å®šä½¿ç”¨browserslistçš„å“ªä¸ªç¯å¢ƒ</span><br>process.env.NODE_ENV = <span class="hljs-string">'production'</span><br><br><span class="hljs-comment">// å¤ç”¨loader</span><br><span class="hljs-keyword">const</span> commonCssLoader =  [<br>    MiniCssExtractPlugin.loader,<br>    <span class="hljs-string">'css-loader'</span>,<br>    &#123;<br>        <span class="hljs-comment">// è¿˜éœ€è¦åœ¨package.jsonä¸­å®šä¹‰browserslist</span><br>        loader: <span class="hljs-string">'postcss-loader'</span>,<br>        options: &#123;<br>            ident: <span class="hljs-string">'postcss'</span>,<br>            plugins: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> [<br>                <span class="hljs-built_in">require</span>(<span class="hljs-string">'postcss-preset-env'</span>)()<br>            ]<br>        &#125;<br>    &#125;<br>]<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">'./src/js/index.js'</span>,<br>    output: &#123;<br>        filename: <span class="hljs-string">'js/built.js'</span>,<br>        path: resolve(__dirname,<span class="hljs-string">'build'</span>)<br>    &#125;,<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.css$/</span>,<br>                use: [...commonCssLoader]<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.less$/</span>,<br>                use: [<br>                    ...commonCssLoader,<br>                    <span class="hljs-string">'less-loader'</span><br>                ]<br>            &#125;,<br>            <span class="hljs-comment">// jsè¯­æ³•æ£€æŸ¥</span><br>            <span class="hljs-comment">/* æ­£å¸¸æ¥è®²ï¼š ä¸€ä¸ªæ–‡ä»¶åªèƒ½è¢«ä¸€ä¸ªLoaderå¤„ç†ã€‚</span><br><span class="hljs-comment">               å½“ä¸€ä¸ªæ–‡ä»¶è¦è¢«å¤šä¸ªloaderå¤„ç†ï¼Œé‚£ä¹ˆä¸€å®šè¦æŒ‡å®šloaderçš„æ‰§è¡Œå…ˆåé¡ºåºï¼š</span><br><span class="hljs-comment">                  å…ˆæ‰§è¡Œeslintï¼Œå†æ‰§è¡Œbabel</span><br><span class="hljs-comment">            */</span><br>            &#123;<br>                <span class="hljs-comment">// åœ¨package.jsonä¸­eslintConfig --&gt; airbnb</span><br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                exclude: <span class="hljs-regexp">/node_module/</span>,<br>                <span class="hljs-comment">// ä¼˜å…ˆæ‰§è¡Œ</span><br>                enforce: <span class="hljs-string">'pre'</span>,<br>                loader: <span class="hljs-string">'eslint-loader'</span>,<br>                options: &#123;<br>                    fix: <span class="hljs-literal">true</span><br>                &#125;<br>            &#125;,<br>            <span class="hljs-comment">// jså…¼å®¹æ€§å¤„ç†</span><br>            &#123;<br>                <span class="hljs-comment">// åœ¨package.jsonä¸­eslintConfig --&gt; airbnb</span><br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                exclude: <span class="hljs-regexp">/node_module/</span>,<br>                loader: <span class="hljs-string">'babel-loader'</span>,<br>                options: &#123;<br>                    presets: [<br>                        <span class="hljs-string">'@babel/preset-env'</span>,<br>                        &#123;<br>                            useBuiltIns: <span class="hljs-string">'usage'</span>,<br>                            corejs: &#123;<span class="hljs-attr">version</span>: <span class="hljs-number">3</span>&#125;,<br>                            targets: &#123;<br>                                chrome: <span class="hljs-string">'60'</span>,<br>                                firefox: <span class="hljs-string">'50'</span><br>                            &#125;<br>                        &#125;<br>                    ]<br>                &#125;<br>            &#125;,<br>            &#123;<br>                test: <span class="hljs-regexp">/\.(gif|jpg|png)/</span>,<br>                loader: <span class="hljs-string">'url-loader'</span>,<br>                options: &#123;<br>                    limit: <span class="hljs-number">8</span> * <span class="hljs-number">1024</span>,<br>                    name: <span class="hljs-string">'[hash:10].[ext]'</span>,<br>                    outputPath: <span class="hljs-string">'imgs'</span>,<br>                    esModule: <span class="hljs-literal">false</span><br>                &#125;<br>            &#125;,<br>            <span class="hljs-comment">// è§£æhtmlä¸­çš„å›¾ç‰‡</span><br>            &#123;<br>                test: <span class="hljs-regexp">/\.html$/</span>,<br>                loader: <span class="hljs-string">'html-loader'</span><br>            &#125;,<br>            <span class="hljs-comment">// å…¶ä»–æ‰€æœ‰çš„æ–‡ä»¶å¤„ç†</span><br>            &#123;<br>                exclude: <span class="hljs-regexp">/\.(js|css|html|less|jpg|png|gif)/</span>,<br>                loader: <span class="hljs-string">'file-loader'</span>,<br>                options: &#123;<br>                    outputPath: <span class="hljs-string">'media'</span><br>                &#125;<br>            &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;<br>            filename: <span class="hljs-string">'css/built.css'</span><br>        &#125;),<br>        <span class="hljs-comment">// å‹ç¼©css</span><br>        <span class="hljs-keyword">new</span> OptimizeCssAssetsWebpackPlugin(),<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">'./src/index.html'</span>,<br>            minify: &#123;<br>                collapseWhitespace: <span class="hljs-literal">true</span>,<br>                removeComments: <span class="hljs-literal">true</span><br>            &#125;<br>        &#125;)<br><br>    ],<br>    mode: <span class="hljs-string">'production'</span><br>&#125;<br></code></pre></td></tr></table></figure>
      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/webpack/" rel="tag">webpack</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
    <article id="post-arry" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/blog/2020/05/23/arry/"
    >æ•°ç»„ä¸­å¸¸ç”¨çš„æ–¹æ³•</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/blog/2020/05/23/arry/" class="article-date">
  <time datetime="2020-05-23T09:45:31.000Z" itemprop="datePublished">2020-05-23</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/JS%E5%9F%BA%E7%A1%80/">JSåŸºç¡€</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="1ã€push"><a href="#1ã€push" class="headerlink" title="1ã€push()"></a>1ã€push()</h3><ul>
<li><p>å‘æ•°ç»„çš„æœ«å°¾å¢åŠ æ–°çš„å†…å®¹ã€‚</p>
</li>
<li><p>è¿”å›æ–°å¢åæ•°ç»„çš„é•¿åº¦ã€‚</p>
</li>
<li><p>åŸæ¥æ•°ç»„å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="2ã€pop"><a href="#2ã€pop" class="headerlink" title="2ã€pop()"></a>2ã€pop()</h3><ul>
<li><p>åˆ é™¤æ•°ç»„æœ€åä¸€é¡¹å†…å®¹ã€‚</p>
</li>
<li><p>è¿”å›è¢«åˆ é™¤çš„é‚£ä¸€é¡¹ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="3ã€shift"><a href="#3ã€shift" class="headerlink" title="3ã€shift()"></a>3ã€shift()</h3><ul>
<li><p>åˆ é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€é¡¹ã€‚</p>
</li>
<li><p>è¿”å›è¢«åˆ é™¤çš„é‚£ä¸€é¡¹ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="4ã€unshhift"><a href="#4ã€unshhift" class="headerlink" title="4ã€unshhift()"></a>4ã€unshhift()</h3><ul>
<li><p>å‘æ•°ç»„çš„å¼€å¤´å¢åŠ å†…å®¹ã€‚</p>
</li>
<li><p>è¿”å›å¢åŠ åæ•°ç»„çš„é•¿åº¦ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="5ã€splice-n-m-x"><a href="#5ã€splice-n-m-x" class="headerlink" title="5ã€splice(n,m,x)"></a>5ã€splice(n,m,x)</h3><ul>
<li><p>ä»ç´¢å¼• n å¼€å§‹ï¼Œåˆ é™¤ m ä¸ªï¼Œç”¨ x æ›¿æ¢åˆ é™¤çš„éƒ¨åˆ†ã€‚</p>
</li>
<li><p>ä»¥æ•°ç»„çš„å½¢å¼è¿”å›è¢«åˆ é™¤çš„å†…å®¹ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„æ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="6ã€slice-n-m"><a href="#6ã€slice-n-m" class="headerlink" title="6ã€slice(n,m)"></a>6ã€slice(n,m)</h3><ul>
<li><p>ä»ç´¢å¼• n å¼€å§‹ï¼Œæ‰¾åˆ°ç´¢å¼• m å¤„ï¼Œå°†æ‰¾åˆ°çš„å†…å®¹ä»¥ä¸€ä¸ªæ–°çš„æ•°ç»„è¿”å›ã€‚</p>
</li>
<li><p>è¿”å›æ‰¾åˆ°çš„æ•°ç»„ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„ä¸å˜ã€‚</p>
</li>
</ul>
<h3 id="7ã€concat"><a href="#7ã€concat" class="headerlink" title="7ã€concat()"></a>7ã€concat()</h3><ul>
<li><p>æŠŠä¸¤ä¸ªæ•°ç»„æ‹¼æ¥åˆ°ä¸€èµ·ã€‚</p>
</li>
<li><p>è¿”å›æ‹¼æ¥åçš„æ•°ç»„ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„ä¸å˜ã€‚</p>
</li>
</ul>
<h3 id="8ã€toString"><a href="#8ã€toString" class="headerlink" title="8ã€toString()"></a>8ã€toString()</h3><ul>
<li><p>æŠŠåŸæ¥çš„æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„ä¸å˜ã€‚</p>
</li>
</ul>
<h3 id="9ã€join"><a href="#9ã€join" class="headerlink" title="9ã€join()"></a>9ã€join()</h3><ul>
<li><p>æŒ‰ç…§æ¯ä¸€ä¸ªåˆ†éš”ç¬¦ï¼ŒæŠŠæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>è¿”å›ä»¥åˆ†éš”ç¬¦æ‹¼æ¥çš„å­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„ä¸å˜ã€‚</p>
</li>
</ul>
<h3 id="10ã€reverse"><a href="#10ã€reverse" class="headerlink" title="10ã€reverse()"></a>10ã€reverse()</h3><ul>
<li><p>æŠŠåŸæ¥çš„æ•°ç»„å€’è¿‡æ¥æ’åˆ—ã€‚</p>
</li>
<li><p>è¿”å›åŸæ¥çš„æ•°ç»„å€’è¿‡æ¥ã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„æ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="11ã€sort"><a href="#11ã€sort" class="headerlink" title="11ã€sort()"></a>11ã€sort()</h3><ul>
<li><p>æ•°ç»„è¿›è¡Œæ’åºã€‚</p>
</li>
<li><p>ary.sort(function(a,b) {return a - b})ç”±å°åˆ°å¤§æ’åºã€‚</p>
</li>
<li><p>ary.sort(function(a,b) {return b - a})ç”±å¤§åˆ°å°æ’åºã€‚</p>
</li>
<li><p>åŸæ¥çš„æ•°ç»„å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="12ã€indexOf-lastIndexOf"><a href="#12ã€indexOf-lastIndexOf" class="headerlink" title="12ã€indexOf()/lastIndexOf()"></a>12ã€indexOf()/lastIndexOf()</h3><ul>
<li><p>å½“å‰å†…å®¹åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡/æœ€åä¸€æ¬¡å‡ºç°ä½ç½®çš„ç´¢å¼•ã€‚</p>
</li>
<li><p>å¦‚æœæ•°ç»„ä¸­æ²¡æœ‰æ‰¾åˆ°è¿”å›-1ï¼Œå¦‚æœæ‰¾åˆ°ç´¢å¼•æ˜¯å‡ å°±è¿”å›å‡ ã€‚</p>
</li>
<li><p>åŸæ¥æ•°ç»„ä¸å˜ã€‚</p>
</li>
</ul>
<h3 id="13ã€map-forEach"><a href="#13ã€map-forEach" class="headerlink" title="13ã€map()/forEach()"></a>13ã€map()/forEach()</h3><ul>
<li><p>éƒ½æ˜¯ç”¨æ¥éå†æ•°ç»„æ¯ä¸€é¡¹ã€‚</p>
</li>
<li><p>map()åŸæ¥æ•°ç»„ä¸å˜ï¼ŒforEach()åŸæ¥å¾—æ•°ç»„æ”¹å˜ã€‚</p>
</li>
</ul>
<h3 id="ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„"><a href="#ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„" class="headerlink" title="ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„"></a>ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„</h3><ul>
<li><p>Array.from()</p>
</li>
<li><p>Array.prototype.slice.call()</p>
</li>
<li><p>Array.prototype.forEach()</p>
</li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JS/" rel="tag">JS</a></li></ul>


    </footer>

  </div>

  

  
  
  

  
  
  

</article>
    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="page-number" href="/blog/page/3/">3</a><a class="extend next" rel="next" href="/blog/page/2/">ä¸‹ä¸€é¡µ</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020
        Ci Xin
      </li>
      <li>
        <!-- 
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
         -->
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
      </li>
      
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/blog/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/blog/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/blog/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/blog/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/blog/about">å…³äº</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/blog/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/blog/images/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/blog/images/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/blog/js/jquery-2.0.3.min.js"></script>


<script src="/blog/js/lazyload.min.js"></script>


<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['é¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€', 'æ„¿ä½ ä¸€ç”ŸåŠªåŠ›ï¼Œä¸€ç”Ÿè¢«çˆ±', 'æƒ³è¦çš„éƒ½æ‹¥æœ‰ï¼Œå¾—ä¸åˆ°çš„éƒ½é‡Šæ€€'],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 100,
      showCursor: true
    });
  } catch (err) {
  }

</script>





<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>



<script src="/blog/dist/main.js"></script>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>





<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

  
<script src="/blog/js/clickLove.js"></script>



<!-- å¤åˆ¶ -->

  
<link rel="stylesheet" href="/blog/css/clipboard.css">

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




    
  </div>
</body>

</html>